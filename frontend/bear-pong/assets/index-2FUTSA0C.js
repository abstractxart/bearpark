import{r as k,g as D}from"./phaser-0YPJO2g1.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function e(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=e(i);fetch(i.href,o)}})();var B=k();const u=D(B);class v{ws=null;serverUrl;messageHandlers=new Map;reconnectAttempts=0;maxReconnectAttempts=5;reconnectDelay=2e3;playerData=null;constructor(t){this.serverUrl=t}connect(){return new Promise((t,e)=>{console.log(`üîå Connecting to Pong server: ${this.serverUrl}`);try{this.ws=new WebSocket(this.serverUrl),this.ws.onopen=()=>{console.log("‚úÖ Connected to Pong server"),this.reconnectAttempts=0,t()},this.ws.onmessage=s=>{try{const i=JSON.parse(s.data);this.handleServerMessage(i)}catch(i){console.error("‚ùå Error parsing server message:",i)}},this.ws.onclose=()=>{console.log("üîå Disconnected from Pong server"),this.attemptReconnect()},this.ws.onerror=s=>{console.error("‚ùå WebSocket error:",s),e(s)}}catch(s){console.error("‚ùå Failed to create WebSocket:",s),e(s)}})}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.log("‚ùå Max reconnect attempts reached"),this.emit("connection_failed",null);return}this.reconnectAttempts++,console.log(`üîÑ Reconnecting... (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect().catch(()=>{})},this.reconnectDelay*this.reconnectAttempts)}handleServerMessage(t){switch(console.log("üì® Received:",t.type,t),t.type){case"queue_joined":this.emit("queue_joined",t.position);break;case"match_found":this.emit("match_found",{opponent:t.opponent,yourSide:t.yourSide});break;case"countdown":this.emit("countdown",t.count);break;case"game_state":this.emit("game_state",t.state);break;case"game_over":this.emit("game_over",{winner:t.winner,finalScore:t.finalScore});break;case"opponent_disconnected":this.emit("opponent_disconnected",null);break;case"rematch_requested":this.emit("rematch_requested",null);break;case"rematch_accepted":this.emit("rematch_accepted",null);break;case"error":this.emit("error",t.message);break;default:console.log("‚ö†Ô∏è Unknown message type:",t.type)}}on(t,e){this.messageHandlers.set(t,e)}emit(t,e){const s=this.messageHandlers.get(t);s&&s(e)}send(t){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(t)):console.error("‚ùå Cannot send message - WebSocket not connected")}joinQueue(t){console.log("üéØ Joining matchmaking queue..."),this.playerData=t,this.send({type:"join_queue",data:t})}getPlayerData(){return this.playerData}movePaddle(t){this.send({type:"paddle_move",y:t,timestamp:Date.now()})}ready(){this.send({type:"ready"})}requestRematch(){this.send({type:"rematch"})}leave(){this.send({type:"leave"})}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}}const P="https://www.bearpark.xyz/api",x="pong";class f{static getWalletAddress(){return localStorage.getItem("xaman_wallet_address")}static getDisplayName(){return localStorage.getItem("display_name")||"Anonymous"}static getAvatarUrl(){return localStorage.getItem("avatar_url")}static getCurrentUserDisplayName(){const t=localStorage.getItem("display_name");if(t&&t.trim()!=="")return t;const e=localStorage.getItem("twitter_username");if(e&&e.trim()!=="")return e;const s=this.getWalletAddress();return s?this.formatWalletAddress(s):"Anonymous"}static isAuthenticated(){return!!this.getWalletAddress()}static async submitWin(t={}){const e=this.getWalletAddress();if(!e)return console.log("‚ÑπÔ∏è Win not submitted - user not authenticated"),{success:!1,error:"Not authenticated",message:"Connect your wallet at bearpark.xyz to save stats!"};const s=this.getLocalStats();s.wins++,this.saveLocalStats(s);try{const i={wallet_address:e,game_id:x,score:s.wins,metadata:{...t,wins:s.wins,losses:s.losses,total_games:s.wins+s.losses,win_rate:s.wins/(s.wins+s.losses),timestamp:new Date().toISOString(),display_name:this.getDisplayName(),result:"win"}};console.log("üì§ Submitting win to BEAR Park API...");const n=await(await fetch(`${P}/leaderboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();return n.success&&console.log("‚úÖ Win submitted to BEAR Park"),n}catch(i){return console.error("‚ùå Error submitting win to BEAR Park:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}}static async submitLoss(t={}){const e=this.getWalletAddress();if(!e)return console.log("‚ÑπÔ∏è Loss not submitted - user not authenticated"),{success:!1,error:"Not authenticated",message:"Connect your wallet at bearpark.xyz to save stats!"};const s=this.getLocalStats();s.losses++,this.saveLocalStats(s);try{const i={wallet_address:e,game_id:x,score:s.wins,metadata:{...t,wins:s.wins,losses:s.losses,total_games:s.wins+s.losses,win_rate:s.wins/(s.wins+s.losses),timestamp:new Date().toISOString(),display_name:this.getDisplayName(),result:"loss"}};console.log("üì§ Submitting loss to BEAR Park API...");const n=await(await fetch(`${P}/leaderboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json();return n.success&&console.log("‚úÖ Loss submitted to BEAR Park"),n}catch(i){return console.error("‚ùå Error submitting loss to BEAR Park:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error"}}}static getLocalStats(){const t=parseInt(localStorage.getItem("pongWins")||"0"),e=parseInt(localStorage.getItem("pongLosses")||"0"),s=t+e,i=s>0?t/s:0;return{wins:t,losses:e,totalGames:s,winRate:i}}static saveLocalStats(t){localStorage.setItem("pongWins",t.wins.toString()),localStorage.setItem("pongLosses",t.losses.toString())}static async getLeaderboard(t=10){try{const e=`${P}/leaderboard/${x}?limit=${t}`;return console.log("üîç Fetching Pong leaderboard from:",e),(await(await fetch(e)).json()).leaderboard||[]}catch(e){return console.error("‚ùå Error fetching Pong leaderboard:",e),[]}}static async getMyStats(){const t=this.getWalletAddress();if(!t)return null;try{return(await(await fetch(`${P}/leaderboard/${x}/${t}`)).json()).entry||null}catch(e){return console.error("‚ùå Error fetching user stats from BEAR Park:",e),null}}static formatWalletAddress(t){return!t||t.length<8?t:`${t.substring(0,4)}...${t.substring(t.length-4)}`}static formatDisplayName(t){return t.display_name?t.display_name:t.twitter_username?t.twitter_username:t.wallet_address?this.formatWalletAddress(t.wallet_address):"Anonymous"}}class A{scene;hitSound=null;whooshSound=null;comboSounds=new Map;scoreSound=null;perfectSound=null;bgMusic=null;masterVolume=.7;musicVolume=.5;sfxVolume=.7;isMuted=!1;volumeBeforeMute={master:.7,music:.5,sfx:.7};constructor(t){this.scene=t,localStorage.getItem("bearPongMuted")==="true"&&(this.isMuted=!0,this.masterVolume=0,this.musicVolume=0,this.sfxVolume=0)}preload(){this.scene.load.audio("hit","https://files.catbox.moe/blmu4h.mp3"),this.scene.load.audio("whoosh","https://files.catbox.moe/e3i5uj.mp3"),this.scene.load.audio("combo2","https://files.catbox.moe/6ho7x5.mp3"),this.scene.load.audio("combo3","https://files.catbox.moe/19lxs0.mp3"),this.scene.load.audio("combo4","https://files.catbox.moe/k9t4e4.mp3"),this.scene.load.audio("combo5","https://files.catbox.moe/aclr7s.mp3"),this.scene.load.audio("score","https://files.catbox.moe/aebxdd.mp3"),this.scene.load.audio("perfect","https://files.catbox.moe/tpt32f.mp3"),this.scene.load.audio("bgMusic","https://files.catbox.moe/g4jylc.mp3"),console.log("üîä Loading audio files from catbox.moe...")}create(){this.hitSound=this.scene.sound.add("hit",{volume:this.masterVolume*this.sfxVolume}),this.whooshSound=this.scene.sound.add("whoosh",{volume:this.masterVolume*this.sfxVolume*.5,loop:!1}),this.comboSounds.set(2,this.scene.sound.add("combo2",{volume:this.masterVolume*this.sfxVolume})),this.comboSounds.set(3,this.scene.sound.add("combo3",{volume:this.masterVolume*this.sfxVolume})),this.comboSounds.set(4,this.scene.sound.add("combo4",{volume:this.masterVolume*this.sfxVolume})),this.comboSounds.set(5,this.scene.sound.add("combo5",{volume:this.masterVolume*this.sfxVolume})),this.scoreSound=this.scene.sound.add("score",{volume:this.masterVolume*this.sfxVolume}),this.perfectSound=this.scene.sound.add("perfect",{volume:this.masterVolume*this.sfxVolume*1.2}),this.bgMusic=this.scene.sound.add("bgMusic",{volume:this.masterVolume*this.musicVolume,loop:!0}),console.log("üîä Audio system initialized - All sounds loaded!")}playHitSound(t,e){if(!this.hitSound)return;const s=1+Math.abs(t)*.3,i=.5+e/15*.5;this.hitSound.play({volume:this.masterVolume*i,rate:s}),console.log(`üîä Hit sound: pitch=${s.toFixed(2)}, volume=${i.toFixed(2)}`)}playWhooshSound(t){if(!this.whooshSound)return;const e=.8+t/15*.6,s=.3+t/15*.5;this.whooshSound.play({volume:this.masterVolume*s*.5,rate:e}),console.log(`üí® Whoosh sound: pitch=${e.toFixed(2)}, speed=${t.toFixed(1)}`)}playComboSound(t){const e=this.comboSounds.get(Math.min(t,5));e&&(e.play({volume:this.masterVolume}),console.log(`üéµ Combo sound: ${t} HIT COMBO!`))}playScoreSound(){this.scoreSound&&(this.scoreSound.play({volume:this.masterVolume}),console.log("üéØ Score sound"))}playPerfectHitSound(){this.perfectSound&&(this.perfectSound.play({volume:this.masterVolume*1.2}),console.log("‚≠ê PERFECT HIT sound!"))}playBackgroundMusic(){this.bgMusic&&(this.bgMusic.isPlaying||this.bgMusic.play())}stopBackgroundMusic(){this.bgMusic&&this.bgMusic.stop()}setMasterVolume(t){this.masterVolume=Phaser.Math.Clamp(t,0,1),this.updateAllVolumes(),console.log(`üîä Master volume set to ${(this.masterVolume*100).toFixed(0)}%`)}setMusicVolume(t){this.musicVolume=Phaser.Math.Clamp(t,0,1),this.bgMusic&&this.bgMusic.setVolume(this.masterVolume*this.musicVolume),console.log(`üéµ Music volume set to ${(this.musicVolume*100).toFixed(0)}%`)}setSFXVolume(t){this.sfxVolume=Phaser.Math.Clamp(t,0,1),this.updateAllVolumes(),console.log(`üîä SFX volume set to ${(this.sfxVolume*100).toFixed(0)}%`)}updateAllVolumes(){this.hitSound&&this.hitSound.setVolume(this.masterVolume*this.sfxVolume),this.whooshSound&&this.whooshSound.setVolume(this.masterVolume*this.sfxVolume*.5),this.scoreSound&&this.scoreSound.setVolume(this.masterVolume*this.sfxVolume),this.perfectSound&&this.perfectSound.setVolume(this.masterVolume*this.sfxVolume*1.2),this.comboSounds.forEach(t=>{t.setVolume(this.masterVolume*this.sfxVolume)}),this.bgMusic&&this.bgMusic.setVolume(this.masterVolume*this.musicVolume)}getVolumes(){return{master:this.masterVolume,music:this.musicVolume,sfx:this.sfxVolume}}mute(){this.isMuted||(this.volumeBeforeMute={master:this.masterVolume,music:this.musicVolume,sfx:this.sfxVolume},this.masterVolume=0,this.musicVolume=0,this.sfxVolume=0,this.isMuted=!0,localStorage.setItem("bearPongMuted","true"),this.updateAllVolumes(),console.log("üîá Audio muted"))}unmute(){this.isMuted&&(this.masterVolume=this.volumeBeforeMute.master,this.musicVolume=this.volumeBeforeMute.music,this.sfxVolume=this.volumeBeforeMute.sfx,this.isMuted=!1,localStorage.setItem("bearPongMuted","false"),this.updateAllVolumes(),console.log("üîä Audio unmuted"))}toggleMute(){this.isMuted?this.unmute():this.mute()}isMutedState(){return this.isMuted}}class _ extends u.Scene{pongClient=null;statusText=null;queuePositionText=null;loadingDots="";loadingTimer=null;statsText=null;audioManager=null;muteButton=null;muteIcon=null;betAmount=10;betText=null;constructor(){super({key:"PongLobbyScene"});const t=localStorage.getItem("bearPongBet");t&&(this.betAmount=Math.max(10,parseInt(t)))}preload(){this.load.image("lobby-bg","https://files.catbox.moe/qnp7wc.png"),this.audioManager||(this.audioManager=new A(this)),this.audioManager.preload()}create(){const{width:t,height:e}=this.cameras.main;this.audioManager=new A(this),this.audioManager.create(),this.audioManager.playBackgroundMusic(),this.add.image(t/2,e/2,"lobby-bg").setDisplaySize(t,e),this.add.text(t/2,100,"BEAR PONG",{fontSize:"64px",color:"#ffae00",fontStyle:"bold",fontFamily:"Luckiest Guy"}).setOrigin(.5),this.add.text(t/2,180,"Multiplayer Mode",{fontSize:"28px",color:"#680cd9",fontFamily:"Luckiest Guy"}).setOrigin(.5),this.displayPlayerStats(),this.createBettingUI(),this.statusText=this.add.text(t/2,450,"Searching for opponent",{fontSize:"36px",color:"#ffffff",fontFamily:"Luckiest Guy"}),this.statusText.setOrigin(.5),this.queuePositionText=this.add.text(t/2,510,"",{fontSize:"22px",color:"#aaaaaa",fontFamily:"Luckiest Guy"}),this.queuePositionText.setOrigin(.5),this.loadingTimer=this.time.addEvent({delay:500,callback:()=>{this.loadingDots=this.loadingDots.length>=3?"":this.loadingDots+".",this.statusText&&this.statusText.setText(`Searching for opponent${this.loadingDots}`)},loop:!0}),this.add.text(t/2,e-150,"Waiting for another player to join...",{fontSize:"20px",color:"#888888",align:"center",fontFamily:"Luckiest Guy"}).setOrigin(.5),this.createMuteButton();const a=this.add.graphics(),r=t*.6,c=55,d=e-80;a.fillStyle(14238017,1),a.fillRoundedRect(t/2-r/2,d-c/2,r,c,10);const h=this.add.text(t/2,d,"RETURN TO BEARPARK",{fontSize:"24px",color:"#ffffff",fontStyle:"bold",fontFamily:"Luckiest Guy"});h.setOrigin(.5),h.setInteractive({useHandCursor:!0}),h.on("pointerdown",()=>{this.cancelMatchmaking()}),h.on("pointerover",()=>{a.clear(),a.fillStyle(16733525,1),a.fillRoundedRect(t/2-r/2,d-c/2,r,c,10)}),h.on("pointerout",()=>{a.clear(),a.fillStyle(14238017,1),a.fillRoundedRect(t/2-r/2,d-c/2,r,c,10)}),this.input.keyboard?.on("keydown-ESC",()=>{this.cancelMatchmaking()}),this.connectToServer()}createTriColorRing(t,e,s,i,o){const n=[6819033,16756224,503304],a=3,r=Math.PI*2/a;for(let c=0;c<a;c++){const d=c*r-Math.PI/2,h=(c+1)*r-Math.PI/2;t.lineStyle(o,n[c]),t.beginPath(),t.arc(e,s,i,d,h,!1),t.strokePath()}}createMuteButton(){this.muteButton=this.add.container(60,60);const t=this.add.circle(0,0,30,6819033);t.setInteractive({useHandCursor:!0}),this.muteButton.add(t);const e=this.add.graphics();this.createTriColorRing(e,0,0,30,4),this.muteButton.add(e),this.muteIcon=this.add.graphics();const s=this.audioManager?.isMutedState()||!1;this.updateMuteIcon(s),this.muteButton.add(this.muteIcon),t.on("pointerdown",()=>{this.toggleMute()}),t.on("pointerover",()=>{this.muteButton?.setScale(1.1)}),t.on("pointerout",()=>{this.muteButton?.setScale(1)})}updateMuteIcon(t){this.muteIcon&&(this.muteIcon.clear(),this.muteIcon.fillStyle(16692481),this.muteIcon.fillRect(-12,-6,6,12),this.muteIcon.beginPath(),this.muteIcon.moveTo(-6,-6),this.muteIcon.lineTo(0,-10),this.muteIcon.lineTo(0,10),this.muteIcon.lineTo(-6,6),this.muteIcon.closePath(),this.muteIcon.fillPath(),t?(this.muteIcon.lineStyle(3,16711680),this.muteIcon.beginPath(),this.muteIcon.moveTo(4,-10),this.muteIcon.lineTo(14,0),this.muteIcon.moveTo(14,-10),this.muteIcon.lineTo(4,0),this.muteIcon.strokePath()):(this.muteIcon.lineStyle(2,16692481),this.muteIcon.beginPath(),this.muteIcon.arc(0,0,8,-Math.PI/4,Math.PI/4),this.muteIcon.strokePath(),this.muteIcon.beginPath(),this.muteIcon.arc(0,0,12,-Math.PI/4,Math.PI/4),this.muteIcon.strokePath()))}toggleMute(){if(this.audioManager){this.audioManager.toggleMute();const t=this.audioManager.isMutedState();this.updateMuteIcon(t)}}createBettingUI(){const{width:t}=this.cameras.main,e=this.add.container(t/2,340),s=this.add.text(0,-50,"üí∞ PLACE YOUR BET üí∞",{fontSize:"24px",color:"#ffae00",fontFamily:"Luckiest Guy",fontStyle:"bold"});s.setOrigin(.5),e.add(s),this.betText=this.add.text(0,0,`${this.betAmount} HONEY`,{fontSize:"48px",color:"#07ae08",fontFamily:"Luckiest Guy",fontStyle:"bold"}),this.betText.setOrigin(.5),e.add(this.betText);const i=this.createBetButton("-",-100,0);i.on("pointerdown",()=>this.changeBet(-10)),e.add(i);const o=this.createBetButton("+",100,0);o.on("pointerdown",()=>this.changeBet(10)),e.add(o),[10,50,100,500,1e3].forEach((r,c)=>{const d=-200+c*100,h=this.add.text(d,40,`${r}`,{fontSize:"16px",color:"#ffffff",fontFamily:"Luckiest Guy",backgroundColor:"#680cd9",padding:{x:10,y:5}});h.setOrigin(.5),h.setInteractive({useHandCursor:!0}),h.on("pointerdown",()=>this.setBet(r)),h.on("pointerover",()=>h.setScale(1.1)),h.on("pointerout",()=>h.setScale(1)),e.add(h)});const a=this.add.text(0,75,"WINNER TAKES ALL!",{fontSize:"18px",color:"#ff4500",fontFamily:"Luckiest Guy"});a.setOrigin(.5),e.add(a)}createBetButton(t,e,s){const i=this.add.container(e,s),o=this.add.circle(0,0,30,6819033);o.setInteractive({useHandCursor:!0}),i.add(o);const n=this.add.text(0,0,t,{fontSize:"36px",color:"#ffffff",fontFamily:"Luckiest Guy",fontStyle:"bold"});return n.setOrigin(.5),i.add(n),o.on("pointerover",()=>i.setScale(1.1)),o.on("pointerout",()=>i.setScale(1)),i}changeBet(t){this.betAmount=Math.max(10,this.betAmount+t),this.updateBetDisplay()}setBet(t){this.betAmount=t,this.updateBetDisplay()}updateBetDisplay(){this.betText&&(this.betText.setText(`${this.betAmount} HONEY`),this.tweens.add({targets:this.betText,scale:{from:1.2,to:1},duration:200,ease:"Back.out"})),localStorage.setItem("bearPongBet",this.betAmount.toString())}displayPlayerStats(){const t=f.getLocalStats(),e=f.getCurrentUserDisplayName(),s=this.add.container(this.cameras.main.width/2,280),i=this.add.text(0,0,`Player: ${e}`,{fontSize:"22px",color:"#ffffff",fontFamily:"Luckiest Guy"});i.setOrigin(.5),s.add(i),this.statsText=this.add.text(0,40,`Wins: ${t.wins}  |  Losses: ${t.losses}  |  Win Rate: ${(t.winRate*100).toFixed(1)}%`,{fontSize:"18px",color:"#07ae08",fontFamily:"Luckiest Guy"}),this.statsText.setOrigin(.5),s.add(this.statsText)}async fetchPlayerAvatar(t){try{const s=await(await fetch(`/api/profile/${t}`)).json();if(s.success&&s.profile&&s.profile.avatar_nft)try{const i=JSON.parse(s.profile.avatar_nft);return i.imageUrl||i.fallbackImageUrl||null}catch{return`https://nft.xrpl-labs.com/${s.profile.avatar_nft}`}return null}catch(e){return console.error("Failed to fetch avatar:",e),null}}async connectToServer(){const t="wss://bear-pong-production.up.railway.app";this.pongClient=new v(t);try{await this.pongClient.connect(),this.setupEventHandlers();const e=f.getWalletAddress()||"guest_"+Date.now(),s=await this.fetchPlayerAvatar(e);console.log("üñºÔ∏è Fetched avatar URL:",s);const i={wallet:e,displayName:f.getCurrentUserDisplayName(),avatarUrl:s||void 0};this.pongClient.joinQueue(i)}catch(e){console.error("Failed to connect to server:",e),this.showConnectionError()}}setupEventHandlers(){this.pongClient&&(this.pongClient.on("queue_joined",t=>{this.queuePositionText&&this.queuePositionText.setText(`Queue position: ${t}`)}),this.pongClient.on("match_found",t=>{console.log("Match found!",t),console.log("üéÆ Opponent data:",t.opponent),console.log("üñºÔ∏è Opponent avatar URL:",t.opponent?.avatarUrl),this.statusText&&this.statusText.setText("Match Found!"),this.loadingTimer&&(this.loadingTimer.destroy(),this.loadingTimer=null),this.time.delayedCall(1e3,()=>{this.startGame(t.opponent,t.yourSide)})}),this.pongClient.on("connection_failed",()=>{this.showConnectionError()}),this.pongClient.on("error",t=>{console.error("Server error:",t),this.showError(t)}))}startGame(t,e){localStorage.setItem("bearPongCurrentBet",this.betAmount.toString()),this.scene.start("PongGameScene",{pongClient:this.pongClient,opponent:t,yourSide:e,betAmount:this.betAmount})}cancelMatchmaking(){this.pongClient&&(this.pongClient.leave(),this.pongClient.disconnect()),this.loadingTimer&&this.loadingTimer.destroy(),this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,"Matchmaking Cancelled",{fontSize:"36px",color:"#ffffff",fontFamily:"Luckiest Guy"}).setOrigin(.5),this.time.delayedCall(2e3,()=>{window.location.href="/"})}showConnectionError(){this.statusText&&(this.statusText.setText("Failed to connect to server"),this.statusText.setColor("#ff6b6b")),this.queuePositionText&&this.queuePositionText.setText("Please try again later"),this.loadingTimer&&(this.loadingTimer.destroy(),this.loadingTimer=null)}showError(t){this.queuePositionText&&(this.queuePositionText.setText(`Error: ${t}`),this.queuePositionText.setColor("#ff6b6b"))}}const l={CANVAS_WIDTH:1280,CANVAS_HEIGHT:720,PADDLE_WIDTH:20,PADDLE_HEIGHT:120,BALL_SIZE:20,PADDLE_SNAP_FACTOR:.85,PADDLE_MAX_VELOCITY:25,INITIAL_BALL_SPEED:6,MAX_BALL_SPEED:15,WINNING_SCORE:3};class T extends u.GameObjects.Container{paddleRect;glowOuter;glowMid;borderYellow;borderGreen;borderPurple;ghostY=0;visualY=0;lastVisualY=0;keyboardVelocity=0;keyboardAcceleration=0;lastPointerY=0;lastTrailTime=0;color;isLocalPlayer=!1;isUsingPointer=!1;pointerDeadzone=.5;hitCombo=0;isCharged=!1;chargeTween=null;constructor(t,e,s,i=16777215){super(t,e,s),this.color=i,this.ghostY=s,this.visualY=s,this.lastVisualY=s,this.glowOuter=t.add.rectangle(0,0,l.PADDLE_WIDTH+20,l.PADDLE_HEIGHT+20,16777215,.15),this.add(this.glowOuter),this.glowMid=t.add.rectangle(0,0,l.PADDLE_WIDTH+12,l.PADDLE_HEIGHT+12,16777215,.3),this.add(this.glowMid),this.borderYellow=t.add.rectangle(0,0,l.PADDLE_WIDTH+8,l.PADDLE_HEIGHT+8,16692481,.9),this.add(this.borderYellow),this.borderGreen=t.add.rectangle(0,0,l.PADDLE_WIDTH+5,l.PADDLE_HEIGHT+5,503304,.9),this.add(this.borderGreen),this.borderPurple=t.add.rectangle(0,0,l.PADDLE_WIDTH+2,l.PADDLE_HEIGHT+2,6819033,.9),this.add(this.borderPurple),this.paddleRect=t.add.rectangle(0,0,l.PADDLE_WIDTH,l.PADDLE_HEIGHT,i),this.add(this.paddleRect),t.add.existing(this)}updateKeyboardInput(t,e){(t||e)&&(this.isUsingPointer=!1),t?(this.keyboardVelocity>=0&&(this.keyboardVelocity=-8),this.keyboardAcceleration=-.25):e?(this.keyboardVelocity<=0&&(this.keyboardVelocity=8),this.keyboardAcceleration=.25):(this.keyboardVelocity=0,this.keyboardAcceleration=0),this.ghostY+=this.keyboardVelocity,this.keyboardVelocity+=this.keyboardAcceleration,this.keyboardVelocity=u.Math.Clamp(this.keyboardVelocity,-25,l.PADDLE_MAX_VELOCITY),this.ghostY=u.Math.Clamp(this.ghostY,l.PADDLE_HEIGHT/2,l.CANVAS_HEIGHT-l.PADDLE_HEIGHT/2)}updatePointerInput(t,e){if(!e){this.isUsingPointer=!1;return}Math.abs(t-this.lastPointerY)<this.pointerDeadzone&&this.lastPointerY!==0||(this.isUsingPointer=!0,this.lastPointerY=t,this.keyboardVelocity=0,this.keyboardAcceleration=0,this.ghostY=t,this.ghostY=u.Math.Clamp(this.ghostY,l.PADDLE_HEIGHT/2,l.CANVAS_HEIGHT-l.PADDLE_HEIGHT/2))}update(){if(this.isUsingPointer)this.visualY=this.ghostY;else{const t=l.PADDLE_SNAP_FACTOR;this.visualY+=(this.ghostY-this.visualY)*t}this.setY(this.visualY),this.isUsingPointer?(this.paddleRect.setScale(1,1),this.borderPurple.setScale(1,1),this.borderGreen.setScale(1,1),this.borderYellow.setScale(1,1),this.glowOuter.setAlpha(.15),this.glowMid.setAlpha(.3)):(this.updateSquashStretch(),this.updateGlowFromSpeed(),this.updateMotionBlur()),this.isLocalPlayer&&this.handleWallBounce(),this.lastVisualY=this.visualY}updatePosition(t){this.ghostY=t}updateSquashStretch(){const t=this.visualY-this.lastVisualY,e=u.Math.Clamp(Math.abs(t)/10,0,.15);Math.abs(t)>1?(this.paddleRect.setScale(1-e*.5,1+e),this.borderPurple.setScale(1-e*.5,1+e),this.borderGreen.setScale(1-e*.5,1+e),this.borderYellow.setScale(1-e*.5,1+e)):(this.paddleRect.setScale(1,1),this.borderPurple.setScale(1,1),this.borderGreen.setScale(1,1),this.borderYellow.setScale(1,1))}updateGlowFromSpeed(){const t=Math.abs(this.keyboardVelocity),e=u.Math.Clamp(t/35,.15,.6);this.glowOuter.setAlpha(e),this.glowMid.setAlpha(e*1.5)}updateMotionBlur(){const t=this.scene.time.now,e=Math.abs(this.visualY-this.lastVisualY);if(e>3&&t-this.lastTrailTime>30){const s=u.Math.Clamp(e/20,0,.4),i=this.scene.add.rectangle(this.x,this.lastVisualY,l.PADDLE_WIDTH,l.PADDLE_HEIGHT,this.color,s);this.scene.tweens.add({targets:i,alpha:0,duration:100,ease:"Power2",onComplete:()=>i.destroy()}),this.lastTrailTime=t}}handleWallBounce(){const t=l.PADDLE_HEIGHT/2,e=l.CANVAS_HEIGHT-l.PADDLE_HEIGHT/2;(this.ghostY<=t||this.ghostY>=e)&&(this.ghostY=u.Math.Clamp(this.ghostY,t,e),this.keyboardVelocity*=-.3,this.scene.cameras.main.shake(50,.002),this.flashPaddle(16711680,50))}flashPaddle(t,e){const s=this.paddleRect.fillColor;this.paddleRect.setFillStyle(t),this.scene.time.delayedCall(e,()=>{this.paddleRect.setFillStyle(s)})}getTop(){return this.y-l.PADDLE_HEIGHT/2}getBottom(){return this.y+l.PADDLE_HEIGHT/2}getGhostY(){return this.ghostY}setLocalPlayer(t){this.isLocalPlayer=t}onHit(){this.hitCombo++,this.isCharged=!0,this.chargeTween&&this.chargeTween.stop();const e=.5+Math.min(this.hitCombo/5,1)*.4;this.glowOuter.setAlpha(e),this.glowMid.setAlpha(e+.2);const s=Math.min(this.hitCombo,5),i=100;for(let o=0;o<s;o++)this.scene.time.delayedCall(o*i,()=>{this.scene.tweens.add({targets:[this.glowOuter,this.glowMid],scale:1.15,duration:i/2,ease:"Quad.easeOut",yoyo:!0})});this.chargeTween=this.scene.tweens.add({targets:[this.glowOuter,this.glowMid],alpha:.15,duration:500,delay:s*i,ease:"Power2",onComplete:()=>{this.isCharged=!1,this.chargeTween=null}}),this.scene.tweens.add({targets:[this.paddleRect,this.borderPurple,this.borderGreen,this.borderYellow],scaleY:.9,duration:30,ease:"Quad.easeOut",yoyo:!0})}resetCharge(){this.hitCombo=0,this.isCharged=!1,this.chargeTween&&(this.chargeTween.stop(),this.chargeTween=null),this.glowOuter.setAlpha(.15),this.glowMid.setAlpha(.3),this.glowOuter.setScale(1),this.glowMid.setScale(1)}getComboCount(){return this.hitCombo}}class V extends u.GameObjects.Container{ballCore;glowOuter;glowMid;glowInner;currentSpeed=l.INITIAL_BALL_SPEED;lastX=0;lastY=0;lastVelocityX=0;pulseTime=0;lastTrailTime=0;COLOR_STOPS=[{speed:6,color:16777215},{speed:8,color:16775388},{speed:10,color:16692481},{speed:11,color:16753920},{speed:13,color:16747520},{speed:15,color:16729344}];constructor(t,e,s){super(t,e,s),this.lastX=e,this.lastY=s,this.glowInner=t.add.arc(0,0,l.BALL_SIZE/2+3,0,360,!1,16777215,0),this.add(this.glowInner),this.glowOuter=t.add.arc(0,0,l.BALL_SIZE/2+12,0,360,!1,16777215,.15),this.add(this.glowOuter),this.glowMid=t.add.arc(0,0,l.BALL_SIZE/2+6,0,360,!1,16777215,.3),this.add(this.glowMid),this.ballCore=t.add.arc(0,0,l.BALL_SIZE/2,0,360,!1,16777215),this.add(this.ballCore),t.add.existing(this)}updatePosition(t,e,s,i){this.setPosition(t,e),s!==void 0&&i!==void 0&&(this.currentSpeed=Math.sqrt(s*s+i*i),this.lastVelocityX!==0&&Math.sign(s)!==Math.sign(this.lastVelocityX)&&this.playBounceEffect(),this.lastVelocityX=s),this.updateVisualEvolution(),this.autoTrail(),this.lastX=t,this.lastY=e}updateVisualEvolution(){const t=this.currentSpeed,e=this.interpolateColor(t);this.ballCore.setFillStyle(e),this.glowOuter.setFillStyle(e),this.glowMid.setFillStyle(e);const s=this.getGlowIntensity(t),i=this.getPulseValue(t);if(this.glowOuter.setAlpha(s.outer+i*.1),this.glowMid.setAlpha(s.mid+i*.15),t>=13){this.glowInner.setAlpha(.7+i*.3);const o=Math.min((t-13)/2,1);this.glowOuter.setScale(1+o*.3),this.glowMid.setScale(1+o*.2)}else this.glowInner.setAlpha(0),this.glowOuter.setScale(1),this.glowMid.setScale(1);this.pulseTime+=.016}interpolateColor(t){t=Math.max(6,Math.min(15,t));let e=this.COLOR_STOPS[0],s=this.COLOR_STOPS[this.COLOR_STOPS.length-1];for(let S=0;S<this.COLOR_STOPS.length-1;S++)if(t>=this.COLOR_STOPS[S].speed&&t<=this.COLOR_STOPS[S+1].speed){e=this.COLOR_STOPS[S],s=this.COLOR_STOPS[S+1];break}const i=(t-e.speed)/(s.speed-e.speed),o=e.color>>16&255,n=e.color>>8&255,a=e.color&255,r=s.color>>16&255,c=s.color>>8&255,d=s.color&255,h=Math.round(o+(r-o)*i),m=Math.round(n+(c-n)*i),y=Math.round(a+(d-a)*i);return h<<16|m<<8|y}getGlowIntensity(t){return t<8?{outer:.15,mid:.3}:t<11?{outer:.25,mid:.45}:t<13?{outer:.5,mid:.65}:{outer:.7,mid:.85}}getPulseValue(t){const e=this.map(t,6,15,.5,3),s=this.map(t,6,15,.1,.4);return Math.sin(this.pulseTime*e*Math.PI*2)*s}autoTrail(){const t=this.scene.time.now,e=this.currentSpeed;let s=100;e>=13?s=50:e>=11?s=60:e>=8&&(s=80),t-this.lastTrailTime>s&&(this.addTrailEffect(),this.lastTrailTime=t)}addTrailEffect(){const t=this.currentSpeed,e=this.interpolateColor(t),s=this.map(t,6,15,l.BALL_SIZE/2+4,l.BALL_SIZE/2+10),i=this.map(t,6,15,.15,.4),o=this.map(t,6,15,200,120),n=this.scene.add.arc(this.x,this.y,s,0,360,!1,e,i);this.scene.tweens.add({targets:n,alpha:0,duration:o,ease:"Power2",onComplete:()=>{n.destroy()}})}playBounceEffect(){const t=this.interpolateColor(this.currentSpeed),e=this.currentSpeed/l.MAX_BALL_SPEED;this.scene.tweens.add({targets:this,scaleX:.6,scaleY:1.4,duration:50,ease:"Quad.easeOut",yoyo:!0,onComplete:()=>{this.scene.tweens.add({targets:this,scaleX:1.3,scaleY:.7,duration:60,ease:"Quad.easeOut",yoyo:!0})}}),this.scene.time.addEvent({delay:16,callback:()=>{this.scene.time.addEvent({delay:16,callback:()=>{}})}});const s=this.map(e,0,1,.3,.8);this.scene.tweens.add({targets:this.ballCore,alpha:s,duration:30,ease:"Quad.easeOut",yoyo:!0});const i=this.scene.add.arc(this.x,this.y,l.BALL_SIZE/2+5,0,360,!1,16777215,.9);this.scene.tweens.add({targets:i,alpha:0,duration:100,ease:"Power2",onComplete:()=>i.destroy()});const o=this.scene.add.arc(this.x,this.y,l.BALL_SIZE/2,0,360,!1,t,.8),n=this.map(e,0,1,2,4),a=this.map(e,0,1,250,150);this.scene.tweens.add({targets:o,scale:n,alpha:0,duration:a,ease:"Quad.easeOut",onComplete:()=>o.destroy()}),this.createParticleExplosion(t,e);const r=this.map(e,0,1,.002,.012),c=this.map(e,0,1,80,120);this.scene.cameras.main.shake(c,r)}createParticleExplosion(t,e){const s=[16692481,6819033,503304,t],i=Math.round(this.map(e,0,1,10,20));for(let o=0;o<i;o++){const n=u.Utils.Array.GetRandom(s),a=Math.PI*2*o/i+u.Math.FloatBetween(-.3,.3),r=this.map(e,0,1,50,200),c=Math.cos(a)*r,d=Math.sin(a)*r,h=this.map(e,0,1,3,8),m=this.scene.add.arc(this.x,this.y,h,0,360,!1,n,1);this.scene.tweens.add({targets:m,x:m.x+c,y:m.y+d,alpha:0,scale:0,duration:this.map(e,0,1,400,300),ease:"Power2",onComplete:()=>m.destroy()})}}map(t,e,s,i,o){return i+(o-i)*((t-e)/(s-e))}getCurrentSpeed(){return this.currentSpeed}}class I extends u.GameObjects.Container{bannerBackground=null;constructor(t,e,s){const i=e==="left"?l.CANVAS_WIDTH/4:l.CANVAS_WIDTH*3/4;super(t,i,80),t.add.existing(this);const n=300,a=60;this.bannerBackground=t.add.rectangle(0,0,n,a,0,.3),this.add(this.bannerBackground);const r=t.add.text(0,0,s,{fontSize:"24px",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:3});r.setOrigin(.5),this.add(r),this.setAlpha(.85)}show(){this.setAlpha(0),this.scene.tweens.add({targets:this,alpha:.85,duration:500,ease:"Power2"})}hide(){this.scene.tweens.add({targets:this,alpha:0,duration:300,ease:"Power2"})}}var w=(g=>(g.TIME_FREEZE="time_freeze",g.PADDLE_DASH="paddle_dash",g.POWER_HIT="power_hit",g))(w||{});const O={time_freeze:{type:"time_freeze",name:"TIME FREEZE",icon:"‚è∞",description:"Slow-mo for 3 seconds",cooldown:1/0},paddle_dash:{type:"paddle_dash",name:"PADDLE DASH",icon:"üöÄ",description:"Teleport to ball",cooldown:1/0},power_hit:{type:"power_hit",name:"POWER HIT",icon:"üí™",description:"Next hit is MEGA",cooldown:1/0}};class H extends u.Scene{pongClient=null;opponent=null;yourSide="left";leftPaddle=null;rightPaddle=null;ball=null;leftBanner=null;rightBanner=null;countdownText=null;centerLine=null;background=null;audioManager=null;cursors=null;wasd=null;lastBallVelocityX=0;lastScore1=0;lastScore2=0;powerHitActive=!1;constructor(){super({key:"PongGameScene"})}init(t){this.pongClient=t.pongClient,this.opponent=t.opponent,this.yourSide=t.yourSide}preload(){this.load.image("background","https://files.catbox.moe/qnp7wc.png"),this.audioManager||(this.audioManager=new A(this)),this.audioManager.preload()}create(){const{width:t,height:e}=this.cameras.main;this.audioManager=new A(this),this.audioManager.create(),this.audioManager.playBackgroundMusic(),this.background=this.add.image(0,0,"background").setOrigin(0),this.background.setDisplaySize(t,e);const s=8;this.add.rectangle(0,0,t,s,16692481).setOrigin(0),this.add.rectangle(0,e-s,t,s,16692481).setOrigin(0),this.drawCenterLine();const i=50+l.PADDLE_WIDTH/2,o=t-50-l.PADDLE_WIDTH/2;this.yourSide==="left"?(this.leftPaddle=new T(this,i,e/2,6819033),this.leftPaddle.setLocalPlayer(!0),this.rightPaddle=new T(this,o,e/2,503304),this.rightPaddle.setLocalPlayer(!1)):(this.leftPaddle=new T(this,i,e/2,6819033),this.leftPaddle.setLocalPlayer(!1),this.rightPaddle=new T(this,o,e/2,503304),this.rightPaddle.setLocalPlayer(!0)),this.ball=new V(this,t/2,e/2),this.createPlayerBanners(),this.countdownText=this.add.text(t/2,e/2-100,"",{fontSize:"128px",color:"#ffffff",fontStyle:"bold"}),this.countdownText.setOrigin(.5),this.setupInput(),this.setupServerHandlers(),this.scene.launch("PongUIScene")}drawCenterLine(){this.centerLine=this.add.graphics(),this.centerLine.lineStyle(2,4473924);const t=20,e=15,s=this.cameras.main.width/2;for(let i=0;i<this.cameras.main.height;i+=t+e)this.centerLine.lineBetween(s,i,s,i+t)}createPlayerBanners(){this.yourSide==="left"?(this.leftBanner=new I(this,"left",f.getCurrentUserDisplayName()),this.rightBanner=new I(this,"right",this.opponent?.displayName||"Opponent")):(this.leftBanner=new I(this,"left",this.opponent?.displayName||"Opponent"),this.rightBanner=new I(this,"right",f.getCurrentUserDisplayName())),this.leftBanner?.show(),this.rightBanner?.show()}setupInput(){this.cursors=this.input.keyboard?.createCursorKeys()||null,this.wasd=this.input.keyboard?.addKeys({up:u.Input.Keyboard.KeyCodes.W,down:u.Input.Keyboard.KeyCodes.S}),this.input.on("pointerdown",t=>{const e=t.x<this.cameras.main.width/2;(this.yourSide==="left"&&e||this.yourSide==="right"&&!e)&&(this.yourSide==="left"?this.leftPaddle:this.rightPaddle)?.updatePointerInput(t.y,!0)}),this.input.on("pointermove",t=>{const e=t.x<this.cameras.main.width/2,s=this.yourSide==="left"&&e||this.yourSide==="right"&&!e;t.isDown&&s&&(this.yourSide==="left"?this.leftPaddle:this.rightPaddle)?.updatePointerInput(t.y,!0)}),this.input.on("pointerup",()=>{(this.yourSide==="left"?this.leftPaddle:this.rightPaddle)?.updatePointerInput(0,!1)})}setupServerHandlers(){this.pongClient&&(this.pongClient.on("countdown",t=>{this.countdownText&&(t>0?(this.countdownText.setText(t.toString()),this.tweens.add({targets:this.countdownText,scale:{from:2,to:1},alpha:{from:1,to:.5},duration:1e3,ease:"Power2"})):(this.countdownText.setText("GO!"),this.tweens.add({targets:this.countdownText,alpha:0,duration:500,delay:500,onComplete:()=>{this.countdownText?.destroy(),this.countdownText=null}})))}),this.pongClient.on("game_state",t=>{this.updateGameState(t);const e=this.scene.get("PongUIScene");e&&e.updateScore&&e.updateScore(t.score1,t.score2);const s=Math.sqrt(t.ballVelocityX*t.ballVelocityX+t.ballVelocityY*t.ballVelocityY);e&&e.updateSpeedMeter&&e.updateSpeedMeter(s)}),this.pongClient.on("game_over",t=>{this.handleGameOver(t.winner,t.finalScore)}),this.pongClient.on("opponent_disconnected",()=>{this.handleOpponentDisconnect()}))}updateGameState(t){if((t.score1!==this.lastScore1||t.score2!==this.lastScore2)&&(this.leftPaddle?.resetCharge(),this.rightPaddle?.resetCharge(),this.audioManager?.playScoreSound(),this.lastScore1=t.score1,this.lastScore2=t.score2),this.lastBallVelocityX!==0&&Math.sign(t.ballVelocityX)!==Math.sign(this.lastBallVelocityX)){const e=Math.sqrt(t.ballVelocityX*t.ballVelocityX+t.ballVelocityY*t.ballVelocityY);if(t.ballVelocityX>0){this.leftPaddle?.onHit();const s=t.paddle1Y,o=(t.ballY-s)/(l.PADDLE_HEIGHT/2);this.audioManager?.playHitSound(o,e);const n=this.leftPaddle?.getComboCount()||0;n>=2&&(this.scene.get("PongUIScene")?.showCombo(n,"left"),this.audioManager?.playComboSound(n))}else{this.rightPaddle?.onHit();const s=t.paddle2Y,o=(t.ballY-s)/(l.PADDLE_HEIGHT/2);this.audioManager?.playHitSound(o,e);const n=this.rightPaddle?.getComboCount()||0;n>=2&&(this.scene.get("PongUIScene")?.showCombo(n,"right"),this.audioManager?.playComboSound(n))}this.cameras.main.zoomTo(1.02,80,"Quad.easeOut",!1),this.time.delayedCall(80,()=>{this.cameras.main.zoomTo(1,120,"Quad.easeIn",!1)}),this.background&&(this.background.setTint(8947848),this.tweens.add({targets:this.background,tint:16777215,duration:150,ease:"Power2"}))}this.lastBallVelocityX=t.ballVelocityX,this.ball&&this.ball.updatePosition(t.ballX,t.ballY,t.ballVelocityX,t.ballVelocityY),this.yourSide==="left"?this.rightPaddle&&this.rightPaddle.updatePosition(t.paddle2Y):this.leftPaddle&&this.leftPaddle.updatePosition(t.paddle1Y)}update(){this.handlePaddleInput(),this.leftPaddle?.update(),this.rightPaddle?.update()}handlePaddleInput(){if(!this.pongClient)return;const t=this.yourSide==="left"?this.leftPaddle:this.rightPaddle;if(!t)return;const e=!!(this.cursors?.up.isDown||this.wasd?.up.isDown),s=!!(this.cursors?.down.isDown||this.wasd?.down.isDown);t.updateKeyboardInput(e,s),this.pongClient.movePaddle(t.getGhostY())}handleGameOver(t,e){console.log("Game over!",t,e);const s=t===this.yourSide;this.scene.stop("PongUIScene"),this.scene.start("PongGameOverScene",{didWin:s,yourScore:this.yourSide==="left"?e.left:e.right,opponentScore:this.yourSide==="left"?e.right:e.left,opponent:this.opponent,pongClient:this.pongClient})}handleOpponentDisconnect(){console.log("Opponent disconnected"),this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,`Opponent Disconnected

You Win by Default!`,{fontSize:"32px",color:"#ffffff",align:"center"}).setOrigin(.5),this.time.delayedCall(3e3,()=>{this.yourSide==="left"?this.leftPaddle?.getTop():this.rightPaddle?.getTop(),this.handleGameOver(this.yourSide,{left:this.yourSide==="left"?l.WINNING_SCORE:0,right:this.yourSide==="right"?l.WINNING_SCORE:0})})}activateUltimate(t){switch(t){case w.TIME_FREEZE:this.activateTimeFreeze();break;case w.PADDLE_DASH:this.activatePaddleDash();break;case w.POWER_HIT:this.activatePowerHit();break}}activateTimeFreeze(){console.log("üöÄ TIME FREEZE ACTIVATED!"),this.tweens.timeScale=.3,this.physics.world.timeScale=.3;const t=this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,255,.3);t.setOrigin(0),this.time.delayedCall(3e3,()=>{this.tweens.timeScale=1,this.physics.world.timeScale=1,this.tweens.add({targets:t,alpha:0,duration:300,onComplete:()=>t.destroy()}),console.log("‚è∞ TIME FREEZE ended")})}activatePaddleDash(){console.log("üöÄ PADDLE DASH ACTIVATED!");const t=this.yourSide==="left"?this.leftPaddle:this.rightPaddle;if(!t||!this.ball)return;const e=this.ball.y;this.createDashParticles(t.y),this.tweens.add({targets:t,y:e,duration:100,ease:"Power2",onComplete:()=>{this.createDashParticles(e)}});const s=this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,16777215,.5);s.setOrigin(0),this.tweens.add({targets:s,alpha:0,duration:200,onComplete:()=>s.destroy()})}createDashParticles(t){const e=this.yourSide==="left"?50+l.PADDLE_WIDTH/2:this.cameras.main.width-50-l.PADDLE_WIDTH/2;for(let s=0;s<20;s++){const i=Math.PI*2*s/20,o=Math.cos(i)*200,n=Math.sin(i)*200,a=this.add.arc(e,t,5,0,360,!1,16692481,1);this.tweens.add({targets:a,x:a.x+o,y:a.y+n,alpha:0,scale:0,duration:400,ease:"Power2",onComplete:()=>a.destroy()})}}activatePowerHit(){console.log("üöÄ POWER HIT ACTIVATED!"),this.powerHitActive=!0;const t=this.yourSide==="left"?this.leftPaddle:this.rightPaddle;if(!t)return;const e=this.add.rectangle(t.x,t.y,l.PADDLE_WIDTH+10,l.PADDLE_HEIGHT+10,16692481,.5);this.tweens.add({targets:e,alpha:{from:.5,to:1},scale:{from:1,to:1.2},duration:500,yoyo:!0,repeat:-1}),this.time.delayedCall(1e4,()=>{this.powerHitActive&&(this.powerHitActive=!1,e.destroy())})}}class G extends u.Scene{leftScoreText=null;rightScoreText=null;winningScoreText=null;comboText=null;comboTween=null;pauseButton=null;muteButton=null;muteIcon=null;speedMeter=null;speedFill=null;speedText=null;speedWarning=null;currentSpeed=6;stakesText=null;ultimateButton=null;ultimateUsed=!1;ultimateType=w.TIME_FREEZE;constructor(){super({key:"PongUIScene"})}create(){const{width:t,height:e}=this.cameras.main;this.leftScoreText=this.add.text(t/4,80,"0",{fontSize:"96px",color:"#4a90e2",fontStyle:"bold"}),this.leftScoreText.setOrigin(.5),this.leftScoreText.setAlpha(.6),this.rightScoreText=this.add.text(t*3/4,80,"0",{fontSize:"96px",color:"#ff6b6b",fontStyle:"bold"}),this.rightScoreText.setOrigin(.5),this.rightScoreText.setAlpha(.6),this.winningScoreText=this.add.text(t/2,30,`First to ${l.WINNING_SCORE}`,{fontSize:"16px",color:"#888888"}),this.winningScoreText.setOrigin(.5),this.createPauseButton(),this.createMuteButton(),this.createSpeedMeter(),this.createStakesDisplay(),this.createUltimateButton(),this.add.text(t/2,e-20,"ESC to pause",{fontSize:"14px",color:"#666666"}).setOrigin(.5),this.input.keyboard?.on("keydown-ESC",()=>{this.pauseGame()})}createTriColorRing(t,e,s,i,o){const n=[6819033,16756224,503304],a=3,r=Math.PI*2/a;for(let c=0;c<a;c++){const d=c*r-Math.PI/2,h=(c+1)*r-Math.PI/2;t.lineStyle(o,n[c]),t.beginPath(),t.arc(e,s,i,d,h,!1),t.strokePath()}}createPauseButton(){const{width:t}=this.cameras.main;this.pauseButton=this.add.container(t-60,60);const e=this.add.circle(0,0,30,6819033);e.setInteractive({useHandCursor:!0}),this.pauseButton.add(e);const s=this.add.graphics();this.createTriColorRing(s,0,0,30,4),this.pauseButton.add(s);const i=this.add.rectangle(-6,0,6,20,16692481),o=this.add.rectangle(6,0,6,20,16692481);this.pauseButton.add(i),this.pauseButton.add(o),e.on("pointerdown",()=>{this.pauseGame()}),e.on("pointerover",()=>{this.pauseButton?.setScale(1.1)}),e.on("pointerout",()=>{this.pauseButton?.setScale(1)})}createMuteButton(){this.muteButton=this.add.container(60,60);const t=this.add.circle(0,0,30,6819033);t.setInteractive({useHandCursor:!0}),this.muteButton.add(t);const e=this.add.graphics();this.createTriColorRing(e,0,0,30,4),this.muteButton.add(e),this.muteIcon=this.add.graphics();const i=this.scene.get("PongGameScene")?.audioManager?.isMutedState()||!1;this.updateMuteIcon(i),this.muteButton.add(this.muteIcon),t.on("pointerdown",()=>{this.toggleMute()}),t.on("pointerover",()=>{this.muteButton?.setScale(1.1)}),t.on("pointerout",()=>{this.muteButton?.setScale(1)})}updateMuteIcon(t){this.muteIcon&&(this.muteIcon.clear(),this.muteIcon.fillStyle(16692481),this.muteIcon.fillRect(-12,-6,6,12),this.muteIcon.beginPath(),this.muteIcon.moveTo(-6,-6),this.muteIcon.lineTo(0,-10),this.muteIcon.lineTo(0,10),this.muteIcon.lineTo(-6,6),this.muteIcon.closePath(),this.muteIcon.fillPath(),t?(this.muteIcon.lineStyle(3,16711680),this.muteIcon.beginPath(),this.muteIcon.moveTo(4,-10),this.muteIcon.lineTo(14,0),this.muteIcon.moveTo(14,-10),this.muteIcon.lineTo(4,0),this.muteIcon.strokePath()):(this.muteIcon.lineStyle(2,16692481),this.muteIcon.beginPath(),this.muteIcon.arc(0,0,8,-Math.PI/4,Math.PI/4),this.muteIcon.strokePath(),this.muteIcon.beginPath(),this.muteIcon.arc(0,0,12,-Math.PI/4,Math.PI/4),this.muteIcon.strokePath()))}toggleMute(){const e=this.scene.get("PongGameScene")?.audioManager;if(e){e.toggleMute();const s=e.isMutedState();this.updateMuteIcon(s)}}pauseGame(){const t=this.scene.get("PongGameScene"),e=t?.audioManager;this.scene.pause("PongGameScene"),this.scene.pause(),this.scene.launch("PongPauseScene",{audioManager:e,gameScene:t})}createSpeedMeter(){const{width:t}=this.cameras.main;this.speedMeter=this.add.container(t/2,130);const e=200,s=10,i=this.add.rectangle(0,0,e,s,0,.5);this.speedMeter.add(i),this.speedFill=this.add.rectangle(-e/2,0,0,s,16692481),this.speedFill.setOrigin(0,.5),this.speedMeter.add(this.speedFill),this.speedText=this.add.text(0,-20,"SPEED",{fontSize:"12px",color:"#888888",fontFamily:"Luckiest Guy"}),this.speedText.setOrigin(.5),this.speedMeter.add(this.speedText),this.speedWarning=this.add.text(0,25,"",{fontSize:"18px",color:"#ff4500",fontFamily:"Luckiest Guy",fontStyle:"bold"}),this.speedWarning.setOrigin(.5),this.speedWarning.setAlpha(0),this.speedMeter.add(this.speedWarning)}updateSpeedMeter(t){if(!this.speedFill||!this.speedText||!this.speedWarning)return;this.currentSpeed=t;const e=6,i=Math.min(1,(t-e)/(15-e)),o=200;this.speedFill.width=o*i;let n=16692481,a="";t>=13?(n=16729344,a="‚ö° MAXIMUM OVERDRIVE! ‚ö°",this.speedWarning.setColor("#ff4500")):t>=11?(n=16747520,a="üî• DANGER ZONE! üî•",this.speedWarning.setColor("#ff8c00")):t>=8&&(n=16753920,a="‚ö†Ô∏è HEATING UP! ‚ö†Ô∏è",this.speedWarning.setColor("#ffa500")),this.speedFill.setFillStyle(n),a?(this.speedWarning.setText(a),this.tweens.add({targets:this.speedWarning,alpha:1,scale:{from:1,to:1.2},duration:500,yoyo:!0,repeat:-1})):(this.speedWarning.setAlpha(0),this.tweens.killTweensOf(this.speedWarning)),t>=13?this.speedText.setColor("#ff4500"):t>=11?this.speedText.setColor("#ff8c00"):t>=8?this.speedText.setColor("#ffa500"):this.speedText.setColor("#feb501")}createStakesDisplay(){const{width:t}=this.cameras.main,s=parseInt(localStorage.getItem("bearPongCurrentBet")||"10")*2;this.stakesText=this.add.text(t/2,165,`üí∞ POT: ${s} HONEY üí∞`,{fontSize:"20px",color:"#ffae00",fontFamily:"Luckiest Guy",fontStyle:"bold",stroke:"#000000",strokeThickness:3}),this.stakesText.setOrigin(.5),this.tweens.add({targets:this.stakesText,scale:{from:1,to:1.1},duration:1e3,yoyo:!0,repeat:-1})}createUltimateButton(){const{width:t,height:e}=this.cameras.main;this.ultimateButton=this.add.container(t/2,e-80);const s=O[this.ultimateType],i=200,n=this.add.rectangle(0,0,i,60,6819033);n.setStrokeStyle(4,16756224),n.setInteractive({useHandCursor:!0}),this.ultimateButton.add(n);const a=this.add.graphics();this.createTriColorRing(a,0,0,i/2+5,6),this.ultimateButton.add(a);const r=this.add.text(0,0,`${s.icon} ${s.name}`,{fontSize:"24px",color:"#ffffff",fontFamily:"Luckiest Guy",fontStyle:"bold"});r.setOrigin(.5),this.ultimateButton.add(r),n.on("pointerdown",()=>{this.useUltimate()}),n.on("pointerover",()=>{this.ultimateUsed||this.ultimateButton?.setScale(1.1)}),n.on("pointerout",()=>{this.ultimateButton?.setScale(1)}),this.tweens.add({targets:this.ultimateButton,scale:{from:1,to:1.05},duration:1e3,yoyo:!0,repeat:-1})}useUltimate(){if(this.ultimateUsed)return;this.ultimateUsed=!0;const t=this.ultimateButton?.list[1];t&&(t.setFillStyle(4473924),t.setStrokeStyle(4,6710886)),this.tweens.killTweensOf(this.ultimateButton);const e=this.add.text(0,35,"USED",{fontSize:"16px",color:"#888888",fontFamily:"Luckiest Guy"});e.setOrigin(.5),this.ultimateButton?.add(e);const s=this.scene.get("PongGameScene");s&&s.activateUltimate&&s.activateUltimate(this.ultimateType),this.showUltimateActivation()}showUltimateActivation(){const{width:t,height:e}=this.cameras.main,s=O[this.ultimateType],i=this.add.text(t/2,e/2,`${s.icon} ${s.name.toUpperCase()}! ${s.icon}`,{fontSize:"72px",color:"#ffae00",fontFamily:"Luckiest Guy",fontStyle:"bold",stroke:"#000000",strokeThickness:8});i.setOrigin(.5),i.setAlpha(0),this.tweens.add({targets:i,alpha:1,scale:{from:0,to:1.5},duration:300,ease:"Back.out",onComplete:()=>{this.time.delayedCall(800,()=>{this.tweens.add({targets:i,alpha:0,scale:2,duration:400,ease:"Power2",onComplete:()=>i.destroy()})})}});const o=this.add.rectangle(0,0,t,e,16777215,.5);o.setOrigin(0),this.tweens.add({targets:o,alpha:0,duration:500,onComplete:()=>o.destroy()})}updateScore(t,e){const{width:s,height:i}=this.cameras.main;if(this.leftScoreText){const o=parseInt(this.leftScoreText.text)||0;if(this.leftScoreText.setText(t.toString()),o!==t&&t>o){const n=this.add.text(s/4,i/2,t.toString(),{fontSize:"256px",color:"#4a90e2",fontStyle:"bold"});n.setOrigin(.5),n.setAlpha(1),this.tweens.add({targets:n,scale:{from:1,to:.375},x:s/4,y:80,alpha:0,duration:800,ease:"Back.in",onComplete:()=>{n.destroy(),this.tweens.add({targets:this.leftScoreText,scale:{from:1.5,to:1},duration:400,ease:"Elastic.out"})}})}}if(this.rightScoreText){const o=parseInt(this.rightScoreText.text)||0;if(this.rightScoreText.setText(e.toString()),o!==e&&e>o){const n=this.add.text(s*3/4,i/2,e.toString(),{fontSize:"256px",color:"#ff6b6b",fontStyle:"bold"});n.setOrigin(.5),n.setAlpha(1),this.tweens.add({targets:n,scale:{from:1,to:.375},x:s*3/4,y:80,alpha:0,duration:800,ease:"Back.in",onComplete:()=>{n.destroy(),this.tweens.add({targets:this.rightScoreText,scale:{from:1.5,to:1},duration:400,ease:"Elastic.out"})}})}}}showCombo(t,e){if(t<2)return;const{width:s,height:i}=this.cameras.main;this.comboTween&&(this.comboTween.stop(),this.comboText?.destroy());const o=e==="left"?s/4:s*3/4,n=e==="left"?"#4a90e2":"#ff6b6b";this.comboText=this.add.text(o,i/2+100,`${t} HIT COMBO!`,{fontSize:"48px",color:n,fontStyle:"bold"}),this.comboText.setOrigin(.5),this.comboText.setAlpha(0),this.comboTween=this.tweens.add({targets:this.comboText,alpha:1,scale:{from:0,to:1.2},duration:200,ease:"Back.out",onComplete:()=>{this.time.delayedCall(500,()=>{this.tweens.add({targets:this.comboText,alpha:0,scale:.8,duration:300,ease:"Power2",onComplete:()=>{this.comboText?.destroy(),this.comboText=null}})})}})}}const p={PURPLE:6819033,GREEN:503304,YELLOW:16692481,CHARCOAL:1316377,WHITE:16777215};class R extends u.Scene{audioManager=null;gameScene=null;overlay=null;container=null;masterHandle=null;musicHandle=null;sfxHandle=null;masterTrack=null;musicTrack=null;sfxTrack=null;constructor(){super({key:"PongPauseScene"})}init(t){this.audioManager=t.audioManager,this.gameScene=t.gameScene}create(){const{width:t,height:e}=this.cameras.main;this.overlay=this.add.rectangle(0,0,t,e,0,.85),this.overlay.setOrigin(0),this.overlay.setInteractive(),this.container=this.add.container(t/2,e/2);const o=this.add.rectangle(0,0,500,300,p.CHARCOAL);o.setStrokeStyle(6,p.YELLOW),this.container.add(o);const n=this.add.text(0,-50,"PAUSED",{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"56px",color:"#feb501"});n.setOrigin(.5),this.container.add(n),this.createButton("RESUME",30,p.GREEN,()=>{this.resumeGame()}),this.createButton("QUIT",110,p.PURPLE,()=>{this.quitGame()}),this.input.keyboard?.on("keydown-ESC",()=>{this.resumeGame()})}createVolumeSlider(t,e,s,i){if(!this.container)return;const o=this.add.text(-70,e,t,{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"24px",color:"#feb501"});o.setOrigin(1,.5),this.container.add(o);const n=200,a=8,r=this.add.rectangle(50,e,n,a,p.WHITE,.3);this.container.add(r);const c=n*s,d=this.add.rectangle(50-n/2+c/2,e,c,a);d.setOrigin(.5),i==="master"?d.setFillStyle(p.YELLOW):i==="music"?d.setFillStyle(p.PURPLE):d.setFillStyle(p.GREEN),this.container.add(d);const h=50-n/2+n*s,m=this.add.circle(h,e,12,p.WHITE);m.setStrokeStyle(3,p.YELLOW),m.setInteractive({draggable:!0,useHandCursor:!0}),this.container.add(m),i==="master"?(this.masterHandle=m,this.masterTrack=r):i==="music"?(this.musicHandle=m,this.musicTrack=r):(this.sfxHandle=m,this.sfxTrack=r);const y=this.add.text(160,e,`${Math.round(s*100)}%`,{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"20px",color:"#ffffff"});y.setOrigin(0,.5),this.container.add(y),m.on("drag",(S,N)=>{const C=r.x-n/2,L=r.x+n/2,E=u.Math.Clamp(S.x-(this.container?.x||0),C,L);m.x=E;const b=(E-C)/n,M=n*b;d.width=M,d.x=r.x-n/2+M/2,y.setText(`${Math.round(b*100)}%`),i==="master"?this.audioManager?.setMasterVolume(b):i==="music"?this.audioManager?.setMusicVolume(b):this.audioManager?.setSFXVolume(b)})}createButton(t,e,s,i){if(!this.container)return;const a=this.add.rectangle(0,e,300,50,s);a.setStrokeStyle(4,p.YELLOW),a.setInteractive({useHandCursor:!0}),this.container.add(a);const r=this.add.text(0,e,t,{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"28px",color:"#feb501"});r.setOrigin(.5),this.container.add(r),a.on("pointerover",()=>{a.setScale(1.05),r.setScale(1.05)}),a.on("pointerout",()=>{a.setScale(1),r.setScale(1)}),a.on("pointerdown",i)}resumeGame(){this.scene.resume("PongGameScene"),this.scene.resume("PongUIScene"),this.scene.stop()}quitGame(){const t=this.add.rectangle(0,0,this.cameras.main.width,this.cameras.main.height,0,.5);t.setOrigin(0);const e=this.add.rectangle(this.cameras.main.width/2,this.cameras.main.height/2,400,250,p.CHARCOAL);e.setStrokeStyle(6,p.YELLOW);const s=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2-40,`QUIT GAME?

You will return to
BEAR Park`,{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"24px",color:"#feb501",align:"center"});s.setOrigin(.5);const i=this.add.rectangle(this.cameras.main.width/2-80,this.cameras.main.height/2+70,120,45,p.GREEN);i.setStrokeStyle(3,p.YELLOW),i.setInteractive({useHandCursor:!0});const o=this.add.text(this.cameras.main.width/2-80,this.cameras.main.height/2+70,"YES",{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"24px",color:"#feb501"});o.setOrigin(.5),i.on("pointerdown",()=>{this.audioManager?.stopBackgroundMusic(),this.scene.stop("PongGameScene"),this.scene.stop("PongUIScene"),this.scene.stop(),window.location.href="/"});const n=this.add.rectangle(this.cameras.main.width/2+80,this.cameras.main.height/2+70,120,45,p.PURPLE);n.setStrokeStyle(3,p.YELLOW),n.setInteractive({useHandCursor:!0});const a=this.add.text(this.cameras.main.width/2+80,this.cameras.main.height/2+70,"NO",{fontFamily:"Luckiest Guy, Arial Black, Impact",fontSize:"24px",color:"#feb501"});a.setOrigin(.5),n.on("pointerdown",()=>{t.destroy(),e.destroy(),s.destroy(),i.destroy(),o.destroy(),n.destroy(),a.destroy()})}}class W extends u.Scene{didWin=!1;yourScore=0;opponentScore=0;opponent=null;pongClient=null;leaderboard=[];constructor(){super({key:"PongGameOverScene"})}init(t){this.didWin=t.didWin,this.yourScore=t.yourScore,this.opponentScore=t.opponentScore,this.opponent=t.opponent,this.pongClient=t.pongClient}async create(){const{width:t,height:e}=this.cameras.main;this.add.rectangle(0,0,t,e,1710618,1).setOrigin(0);const s=this.add.text(t/2,100,this.didWin?"VICTORY!":"GAME OVER",{fontSize:"64px",color:this.didWin?"#07ae08":"#ffae00",fontStyle:"bold",fontFamily:"Luckiest Guy"});s.setOrigin(.5),s.setStroke("#000000",6),this.displayStarRating(t/2,160),this.displayWinnings(t/2,200),this.displayScoreBox(t/2,280),await this.submitResult(),this.awardHoneyPoints(),await this.loadAndDisplayLeaderboard(t/2,400),this.createStyledButtons(t/2,e-200)}async submitResult(){try{this.didWin?(await f.submitWin({opponent:this.opponent?.displayName,your_score:this.yourScore,opponent_score:this.opponentScore}),console.log("‚úÖ Win submitted to BEARpark")):(await f.submitLoss({opponent:this.opponent?.displayName,your_score:this.yourScore,opponent_score:this.opponentScore}),console.log("‚úÖ Loss submitted to BEARpark"))}catch(t){console.error("‚ùå Error submitting result:",t)}}displayStats(t,e){const s=f.getLocalStats(),i=this.add.container(t,e),o=this.add.text(0,0,"Your Stats",{fontSize:"24px",color:"#4a90e2",fontStyle:"bold",fontFamily:"Luckiest Guy"});o.setOrigin(.5),o.setStroke("#000000",3),i.add(o);const n=this.add.text(0,40,`Wins: ${s.wins}  |  Losses: ${s.losses}  |  Win Rate: ${(s.winRate*100).toFixed(1)}%`,{fontSize:"18px",color:"#ffffff"});n.setOrigin(.5),i.add(n),i.setAlpha(0),this.tweens.add({targets:i,alpha:1,duration:500,delay:300})}async loadAndDisplayLeaderboard(t,e){const s=this.add.container(t,e),i=this.add.text(0,0,"üèÜ TOP 10 PLAYERS üèÜ",{fontSize:"32px",color:"#ffae00",fontStyle:"bold",fontFamily:"Luckiest Guy"});i.setOrigin(.5),i.setStroke("#000000",3),s.add(i);const o=this.add.text(0,40,"Loading...",{fontSize:"16px",color:"#888888"});o.setOrigin(.5),s.add(o);try{if(this.leaderboard=await f.getLeaderboard(10),o.destroy(),this.leaderboard.length>0)this.leaderboard.forEach((n,a)=>{const r=f.formatDisplayName(n),c=n.score||n.metadata?.wins||0,d=n.metadata?.losses||0,h=this.add.text(0,40+a*30,`${a+1}. ${r} - ${c}W ${d}L`,{fontSize:"18px",color:"#ffffff",fontFamily:"Luckiest Guy"});h.setOrigin(.5),s.add(h)});else{const n=this.add.text(0,40,"No leaderboard data yet",{fontSize:"16px",color:"#888888"});n.setOrigin(.5),s.add(n)}}catch(n){o.setText("Failed to load leaderboard"),console.error("Error loading leaderboard:",n)}s.setAlpha(0),this.tweens.add({targets:s,alpha:1,duration:500,delay:600})}createButtons(t,e){const s=this.add.text(t,e,"[ Play Again ]",{fontSize:"24px",color:"#4ade80"});s.setOrigin(.5),s.setInteractive({useHandCursor:!0}),s.on("pointerover",()=>{s.setScale(1.1)}),s.on("pointerout",()=>{s.setScale(1)}),s.on("pointerdown",()=>{this.playAgain()});const i=this.add.text(t,e+60,"[ Main Menu ]",{fontSize:"20px",color:"#888888"});i.setOrigin(.5),i.setInteractive({useHandCursor:!0}),i.on("pointerover",()=>{i.setScale(1.1),i.setColor("#ffffff")}),i.on("pointerout",()=>{i.setScale(1),i.setColor("#888888")}),i.on("pointerdown",()=>{this.returnToMenu()}),s.setAlpha(0),i.setAlpha(0),this.tweens.add({targets:[s,i],alpha:1,duration:500,delay:900})}playAgain(){this.pongClient&&this.pongClient.disconnect(),this.scene.start("PongLobbyScene")}returnToMenu(){this.pongClient&&this.pongClient.disconnect(),window.location.href="/"}awardHoneyPoints(){try{typeof window.handlePongGameCompletion=="function"?(window.handlePongGameCompletion(),console.log("‚úÖ Honey points handler called")):console.log("‚ö†Ô∏è Honey points handler not found - game may not be embedded in BEARpark site")}catch(t){console.error("‚ùå Error calling honey points handler:",t)}}displayWinnings(t,e){const s=parseInt(localStorage.getItem("bearPongCurrentBet")||"10"),i=s*2;let o="",n="";this.didWin?(o=`+${i} HONEY WON! üéâ`,n="#07ae08"):(o=`-${s} HONEY LOST üò¢`,n="#ff4500");const a=this.add.text(t,e,o,{fontSize:"32px",color:n,fontFamily:"Luckiest Guy",fontStyle:"bold",stroke:"#000000",strokeThickness:4});a.setOrigin(.5),this.tweens.add({targets:a,scale:{from:1,to:1.2},duration:800,yoyo:!0,repeat:-1})}displayStarRating(t,e){const s=this.didWin?this.yourScore>=3?5:3:1,i=48,o=45,n=t-o*2;for(let a=0;a<5;a++)this.add.text(n+a*o,e,"‚òÖ",{fontSize:i+"px",color:a<s?"#FFD700":"#404040"}).setOrigin(.5)}displayScoreBox(t,e){const s=f.getLocalStats(),{width:i}=this.cameras.main,o=i*.85,n=120,a=this.add.graphics();a.lineStyle(5,6819033,1),a.strokeRoundedRect(t-o/2,e-n/2,o,n,15),a.fillStyle(2763306,.95),a.fillRoundedRect(t-o/2+5,e-n/2+5,o-10,n-10,12);const r=this.add.text(t,e-30,"YOUR SCORE",{fontSize:"26px",color:"#ffae00",fontStyle:"bold",fontFamily:"Luckiest Guy"});r.setOrigin(.5),r.setStroke("#000000",3),this.add.text(t,e+10,s.wins.toString(),{fontSize:"60px",color:"#ffffff",fontStyle:"bold",fontFamily:"Luckiest Guy"}).setOrigin(.5),this.add.text(t,e+40,`üèÜ ${s.wins} WIN${s.wins!==1?"S":""}`,{fontSize:"20px",color:"#FFD700",fontFamily:"Luckiest Guy"}).setOrigin(.5)}createStyledButtons(t,e){const{width:s}=this.cameras.main,i=s*.8,o=55,n=this.add.graphics();n.fillStyle(503304,1),n.fillRoundedRect(t-i/2,e-o/2,i,o,10);const a=this.add.text(t,e,"TAP TO RETRY",{fontSize:"28px",color:"#ffffff",fontStyle:"bold",fontFamily:"Luckiest Guy"});a.setOrigin(.5);const r=this.add.container(0,0);r.add([n,a]),r.setInteractive(new u.Geom.Rectangle(t-i/2,e-o/2,i,o),u.Geom.Rectangle.Contains),r.on("pointerdown",()=>{this.playAgain()}),r.on("pointerover",()=>{n.clear(),n.fillStyle(643082,1),n.fillRoundedRect(t-i/2,e-o/2,i,o,10)}),r.on("pointerout",()=>{n.clear(),n.fillStyle(503304,1),n.fillRoundedRect(t-i/2,e-o/2,i,o,10)});const c=e+75,d=this.add.graphics();d.fillStyle(16756224,1),d.fillRoundedRect(t-i/2,c-o/2,i,o,10);const h=this.add.text(t,c,"BACK TO BEARPARK",{fontSize:"24px",color:"#ffffff",fontStyle:"bold",fontFamily:"Luckiest Guy"});h.setOrigin(.5);const m=this.add.container(0,0);m.add([d,h]),m.setInteractive(new u.Geom.Rectangle(t-i/2,c-o/2,i,o),u.Geom.Rectangle.Contains),m.on("pointerdown",()=>{this.returnToMenu()}),m.on("pointerover",()=>{h.setColor("#ffae00")}),m.on("pointerout",()=>{h.setColor("#ffffff")})}}const F={type:u.AUTO,width:1280,height:720,parent:"game-container",backgroundColor:"#000000",scale:{mode:u.Scale.FIT,autoCenter:u.Scale.CENTER_BOTH},scene:[_,H,G,R,W],physics:{default:"arcade",arcade:{debug:!1,fps:60}}},Y=new u.Game(F);Y.scene.start("PongLobbyScene");console.log("üéÆ BEAR PONG initialized");console.log("üîå Server URL:","wss://bear-pong-production.up.railway.app");
