var A=Object.defineProperty;var b=(d,s,t)=>s in d?A(d,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[s]=t;var i=(d,s,t)=>b(d,typeof s!="symbol"?s+"":s,t);import{P as c}from"./phaser-skL0-YrO.js";class C{constructor(s){i(this,"ws",null);i(this,"serverUrl");i(this,"messageHandlers",new Map);i(this,"reconnectAttempts",0);i(this,"maxReconnectAttempts",5);i(this,"reconnectDelay",2e3);this.serverUrl=s}connect(){return new Promise((s,t)=>{console.log(`üîå Connecting to Pong server: ${this.serverUrl}`);try{this.ws=new WebSocket(this.serverUrl),this.ws.onopen=()=>{console.log("‚úÖ Connected to Pong server"),this.reconnectAttempts=0,s()},this.ws.onmessage=e=>{try{const n=JSON.parse(e.data);this.handleServerMessage(n)}catch(n){console.error("‚ùå Error parsing server message:",n)}},this.ws.onclose=()=>{console.log("üîå Disconnected from Pong server"),this.attemptReconnect()},this.ws.onerror=e=>{console.error("‚ùå WebSocket error:",e),t(e)}}catch(e){console.error("‚ùå Failed to create WebSocket:",e),t(e)}})}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){console.log("‚ùå Max reconnect attempts reached"),this.emit("connection_failed",null);return}this.reconnectAttempts++,console.log(`üîÑ Reconnecting... (attempt ${this.reconnectAttempts}/${this.maxReconnectAttempts})`),setTimeout(()=>{this.connect().catch(()=>{})},this.reconnectDelay*this.reconnectAttempts)}handleServerMessage(s){switch(console.log("üì® Received:",s.type,s),s.type){case"queue_joined":this.emit("queue_joined",s.position);break;case"match_found":this.emit("match_found",{opponent:s.opponent,yourSide:s.yourSide});break;case"countdown":this.emit("countdown",s.count);break;case"game_state":this.emit("game_state",s.state);break;case"game_over":this.emit("game_over",{winner:s.winner,finalScore:s.finalScore});break;case"opponent_disconnected":this.emit("opponent_disconnected",null);break;case"rematch_requested":this.emit("rematch_requested",null);break;case"rematch_accepted":this.emit("rematch_accepted",null);break;case"error":this.emit("error",s.message);break;default:console.log("‚ö†Ô∏è Unknown message type:",s.type)}}on(s,t){this.messageHandlers.set(s,t)}emit(s,t){const e=this.messageHandlers.get(s);e&&e(t)}send(s){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(s)):console.error("‚ùå Cannot send message - WebSocket not connected")}joinQueue(s){console.log("üéØ Joining matchmaking queue..."),this.send({type:"join_queue",data:s})}movePaddle(s){this.send({type:"paddle_move",y:s,timestamp:Date.now()})}ready(){this.send({type:"ready"})}requestRematch(){this.send({type:"rematch"})}leave(){this.send({type:"leave"})}disconnect(){this.ws&&(this.ws.close(),this.ws=null)}isConnected(){return this.ws!==null&&this.ws.readyState===WebSocket.OPEN}}const g="https://www.bearpark.xyz/api",f="pong";class h{static getWalletAddress(){return localStorage.getItem("xaman_wallet_address")}static getDisplayName(){return localStorage.getItem("display_name")||"Anonymous"}static getAvatarUrl(){return localStorage.getItem("avatar_url")}static getCurrentUserDisplayName(){const s=localStorage.getItem("display_name");if(s&&s.trim()!=="")return s;const t=localStorage.getItem("twitter_username");if(t&&t.trim()!=="")return t;const e=this.getWalletAddress();return e?this.formatWalletAddress(e):"Anonymous"}static isAuthenticated(){return!!this.getWalletAddress()}static async submitWin(s={}){const t=this.getWalletAddress();if(!t)return console.log("‚ÑπÔ∏è Win not submitted - user not authenticated"),{success:!1,error:"Not authenticated",message:"Connect your wallet at bearpark.xyz to save stats!"};const e=this.getLocalStats();e.wins++,this.saveLocalStats(e);try{const n={wallet_address:t,game_id:f,score:e.wins,metadata:{...s,wins:e.wins,losses:e.losses,total_games:e.wins+e.losses,win_rate:e.wins/(e.wins+e.losses),timestamp:new Date().toISOString(),display_name:this.getDisplayName(),result:"win"}};console.log("üì§ Submitting win to BEAR Park API...");const a=await(await fetch(`${g}/leaderboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();return a.success&&console.log("‚úÖ Win submitted to BEAR Park"),a}catch(n){return console.error("‚ùå Error submitting win to BEAR Park:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}static async submitLoss(s={}){const t=this.getWalletAddress();if(!t)return console.log("‚ÑπÔ∏è Loss not submitted - user not authenticated"),{success:!1,error:"Not authenticated",message:"Connect your wallet at bearpark.xyz to save stats!"};const e=this.getLocalStats();e.losses++,this.saveLocalStats(e);try{const n={wallet_address:t,game_id:f,score:e.wins,metadata:{...s,wins:e.wins,losses:e.losses,total_games:e.wins+e.losses,win_rate:e.wins/(e.wins+e.losses),timestamp:new Date().toISOString(),display_name:this.getDisplayName(),result:"loss"}};console.log("üì§ Submitting loss to BEAR Park API...");const a=await(await fetch(`${g}/leaderboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();return a.success&&console.log("‚úÖ Loss submitted to BEAR Park"),a}catch(n){return console.error("‚ùå Error submitting loss to BEAR Park:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}static getLocalStats(){const s=parseInt(localStorage.getItem("pongWins")||"0"),t=parseInt(localStorage.getItem("pongLosses")||"0"),e=s+t,n=e>0?s/e:0;return{wins:s,losses:t,totalGames:e,winRate:n}}static saveLocalStats(s){localStorage.setItem("pongWins",s.wins.toString()),localStorage.setItem("pongLosses",s.losses.toString())}static async getLeaderboard(s=10){try{const t=`${g}/leaderboard/${f}?limit=${s}`;return console.log("üîç Fetching Pong leaderboard from:",t),(await(await fetch(t)).json()).leaderboard||[]}catch(t){return console.error("‚ùå Error fetching Pong leaderboard:",t),[]}}static async getMyStats(){const s=this.getWalletAddress();if(!s)return null;try{return(await(await fetch(`${g}/leaderboard/${f}/${s}`)).json()).entry||null}catch(t){return console.error("‚ùå Error fetching user stats from BEAR Park:",t),null}}static formatWalletAddress(s){return!s||s.length<8?s:`${s.substring(0,4)}...${s.substring(s.length-4)}`}static formatDisplayName(s){return s.display_name?s.display_name:s.twitter_username?s.twitter_username:s.wallet_address?this.formatWalletAddress(s.wallet_address):"Anonymous"}}class E extends c.Scene{constructor(){super({key:"PongLobbyScene"});i(this,"pongClient",null);i(this,"statusText",null);i(this,"queuePositionText",null);i(this,"loadingDots","");i(this,"loadingTimer",null);i(this,"statsText",null)}create(){var p;const{width:t,height:e}=this.cameras.main;this.add.rectangle(0,0,t,e,0).setOrigin(0),this.add.text(t/2,100,"BEAR PONG",{fontSize:"64px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.add.text(t/2,180,"Multiplayer Mode",{fontSize:"24px",color:"#4a90e2"}).setOrigin(.5),this.displayPlayerStats(),this.statusText=this.add.text(t/2,400,"Searching for opponent",{fontSize:"32px",color:"#ffffff"}),this.statusText.setOrigin(.5),this.queuePositionText=this.add.text(t/2,460,"",{fontSize:"20px",color:"#aaaaaa"}),this.queuePositionText.setOrigin(.5),this.loadingTimer=this.time.addEvent({delay:500,callback:()=>{this.loadingDots=this.loadingDots.length>=3?"":this.loadingDots+".",this.statusText&&this.statusText.setText(`Searching for opponent${this.loadingDots}`)},loop:!0}),this.add.text(t/2,e-150,"Waiting for another player to join...",{fontSize:"18px",color:"#888888",align:"center"}).setOrigin(.5);const l=this.add.text(t/2,e-80,"[ ESC to Cancel ]",{fontSize:"16px",color:"#ff6b6b"});l.setOrigin(.5),l.setInteractive({useHandCursor:!0}),l.on("pointerdown",()=>{this.cancelMatchmaking()}),(p=this.input.keyboard)==null||p.on("keydown-ESC",()=>{this.cancelMatchmaking()}),this.connectToServer()}displayPlayerStats(){const t=h.getLocalStats(),e=h.getCurrentUserDisplayName(),n=this.add.container(this.cameras.main.width/2,280),o=this.add.text(0,0,`Player: ${e}`,{fontSize:"20px",color:"#ffffff"});o.setOrigin(.5),n.add(o),this.statsText=this.add.text(0,40,`Wins: ${t.wins}  |  Losses: ${t.losses}  |  Win Rate: ${(t.winRate*100).toFixed(1)}%`,{fontSize:"16px",color:"#4a90e2"}),this.statsText.setOrigin(.5),n.add(this.statsText)}async connectToServer(){const t="ws://localhost:8080";this.pongClient=new C(t);try{await this.pongClient.connect(),this.setupEventHandlers();const e={wallet:h.getWalletAddress()||"guest_"+Date.now(),displayName:h.getCurrentUserDisplayName(),avatarUrl:h.getAvatarUrl()||void 0};this.pongClient.joinQueue(e)}catch(e){console.error("Failed to connect to server:",e),this.showConnectionError()}}setupEventHandlers(){this.pongClient&&(this.pongClient.on("queue_joined",t=>{this.queuePositionText&&this.queuePositionText.setText(`Queue position: ${t}`)}),this.pongClient.on("match_found",t=>{console.log("Match found!",t),this.statusText&&this.statusText.setText("Match Found!"),this.loadingTimer&&(this.loadingTimer.destroy(),this.loadingTimer=null),this.time.delayedCall(1e3,()=>{this.startGame(t.opponent,t.yourSide)})}),this.pongClient.on("connection_failed",()=>{this.showConnectionError()}),this.pongClient.on("error",t=>{console.error("Server error:",t),this.showError(t)}))}startGame(t,e){this.scene.start("PongGameScene",{pongClient:this.pongClient,opponent:t,yourSide:e})}cancelMatchmaking(){this.pongClient&&(this.pongClient.leave(),this.pongClient.disconnect()),this.loadingTimer&&this.loadingTimer.destroy(),this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,"Matchmaking Cancelled",{fontSize:"32px",color:"#ffffff"}).setOrigin(.5),this.time.delayedCall(2e3,()=>{window.location.href="/"})}showConnectionError(){this.statusText&&(this.statusText.setText("Failed to connect to server"),this.statusText.setColor("#ff6b6b")),this.queuePositionText&&this.queuePositionText.setText("Please try again later"),this.loadingTimer&&(this.loadingTimer.destroy(),this.loadingTimer=null)}showError(t){this.queuePositionText&&(this.queuePositionText.setText(`Error: ${t}`),this.queuePositionText.setColor("#ff6b6b"))}}const r={CANVAS_HEIGHT:1280,PADDLE_WIDTH:20,PADDLE_HEIGHT:150,BALL_SIZE:20,PADDLE_SPEED:8,WINNING_SCORE:3};class x extends c.GameObjects.Rectangle{constructor(s,t,e,n=16777215){super(s,t,e,r.PADDLE_WIDTH,r.PADDLE_HEIGHT,n),s.add.existing(this)}updatePosition(s){this.y=c.Math.Clamp(s,r.PADDLE_HEIGHT/2,r.CANVAS_HEIGHT-r.PADDLE_HEIGHT/2)}getTop(){return this.y-r.PADDLE_HEIGHT/2}getBottom(){return this.y+r.PADDLE_HEIGHT/2}}class v extends c.GameObjects.Arc{constructor(s,t,e){super(s,t,e,r.BALL_SIZE/2,0,360,!1,16777215),s.add.existing(this)}updatePosition(s,t){this.setPosition(s,t)}addTrailEffect(){const s=this.scene.add.arc(this.x,this.y,r.BALL_SIZE/2,0,360,!1,16777215,.3);this.scene.tweens.add({targets:s,alpha:0,duration:200,onComplete:()=>{s.destroy()}})}}class m extends c.GameObjects.Container{constructor(t,e,n,o,a){super(t,e,n);i(this,"avatarImage",null);i(this,"avatarCircle",null);i(this,"nameText",null);i(this,"paddleY",0);t.add.existing(this),this.paddleY=n,this.avatarCircle=t.add.arc(0,0,r.PADDLE_HEIGHT/2,0,360,!1,4886754,.3),this.add(this.avatarCircle),a&&a.trim()!==""?this.loadAvatar(a):this.showPlaceholder(o),this.nameText=t.add.text(0,r.PADDLE_HEIGHT/2+20,o,{fontSize:"14px",color:"#ffffff",align:"center"}),this.nameText.setOrigin(.5,0),this.add(this.nameText),this.setAlpha(.6)}loadAvatar(t){const e=`avatar_${Date.now()}_${Math.random()}`;this.scene.load.image(e,t),this.scene.load.once("complete",()=>{this.displayAvatar(e)}),this.scene.load.start()}displayAvatar(t){if(this.scene.textures.exists(t)){this.avatarImage=this.scene.add.image(0,0,t);const n=r.PADDLE_HEIGHT/Math.max(this.avatarImage.width,this.avatarImage.height);this.avatarImage.setScale(n);const o=this.scene.make.graphics({});o.fillStyle(16777215),o.fillCircle(this.x,this.y,r.PADDLE_HEIGHT/2),this.avatarImage.setMask(o.createGeometryMask()),this.add(this.avatarImage)}}showPlaceholder(t){var a;const e=t.trim().split(" ");let n=((a=e[0])==null?void 0:a.charAt(0).toUpperCase())||"?";e.length>1&&(n+=e[1].charAt(0).toUpperCase());const o=this.scene.add.text(0,0,n,{fontSize:"32px",color:"#ffffff",fontStyle:"bold"});o.setOrigin(.5),this.add(o)}updatePosition(t){this.paddleY=t,this.y=t}show(){this.setAlpha(0),this.scene.tweens.add({targets:this,alpha:.6,duration:500,ease:"Power2"})}hide(){this.scene.tweens.add({targets:this,alpha:0,duration:300,ease:"Power2"})}}class D extends c.Scene{constructor(){super({key:"PongGameScene"});i(this,"pongClient",null);i(this,"opponent",null);i(this,"yourSide","left");i(this,"leftPaddle",null);i(this,"rightPaddle",null);i(this,"ball",null);i(this,"leftAvatar",null);i(this,"rightAvatar",null);i(this,"countdownText",null);i(this,"centerLine",null);i(this,"cursors",null);i(this,"wasd",null);i(this,"touchStartY",0);i(this,"paddleTargetY",r.CANVAS_HEIGHT/2)}init(t){this.pongClient=t.pongClient,this.opponent=t.opponent,this.yourSide=t.yourSide}create(){const{width:t,height:e}=this.cameras.main;this.add.rectangle(0,0,t,e,0).setOrigin(0),this.drawCenterLine();const n=50+r.PADDLE_WIDTH/2,o=t-50-r.PADDLE_WIDTH/2;this.leftPaddle=new x(this,n,e/2,4886754),this.rightPaddle=new x(this,o,e/2,16739179),this.ball=new v(this,t/2,e/2),this.createPlayerAvatars(),this.countdownText=this.add.text(t/2,e/2-100,"",{fontSize:"128px",color:"#ffffff",fontStyle:"bold"}),this.countdownText.setOrigin(.5),this.setupInput(),this.setupServerHandlers(),this.scene.launch("PongUIScene")}drawCenterLine(){this.centerLine=this.add.graphics(),this.centerLine.lineStyle(2,4473924);const t=20,e=15,n=this.cameras.main.width/2;for(let o=0;o<this.cameras.main.height;o+=t+e)this.centerLine.lineBetween(n,o,n,o+t)}createPlayerAvatars(){var n,o,a,l,p,u;const t=50+r.PADDLE_WIDTH/2,e=this.cameras.main.width-50-r.PADDLE_WIDTH/2;this.yourSide==="left"?(this.leftAvatar=new m(this,t,this.cameras.main.height/2,h.getCurrentUserDisplayName(),h.getAvatarUrl()||void 0),this.rightAvatar=new m(this,e,this.cameras.main.height/2,((n=this.opponent)==null?void 0:n.displayName)||"Opponent",(o=this.opponent)==null?void 0:o.avatarUrl)):(this.leftAvatar=new m(this,t,this.cameras.main.height/2,((a=this.opponent)==null?void 0:a.displayName)||"Opponent",(l=this.opponent)==null?void 0:l.avatarUrl),this.rightAvatar=new m(this,e,this.cameras.main.height/2,h.getCurrentUserDisplayName(),h.getAvatarUrl()||void 0)),(p=this.leftAvatar)==null||p.show(),(u=this.rightAvatar)==null||u.show()}setupInput(){var t,e;this.cursors=((t=this.input.keyboard)==null?void 0:t.createCursorKeys())||null,this.wasd=(e=this.input.keyboard)==null?void 0:e.addKeys({up:c.Input.Keyboard.KeyCodes.W,down:c.Input.Keyboard.KeyCodes.S}),this.input.on("pointerdown",n=>{this.touchStartY=n.y}),this.input.on("pointermove",n=>{n.isDown&&(this.paddleTargetY=n.y)}),this.input.on("pointerup",()=>{})}setupServerHandlers(){this.pongClient&&(this.pongClient.on("countdown",t=>{this.countdownText&&(t>0?(this.countdownText.setText(t.toString()),this.tweens.add({targets:this.countdownText,scale:{from:2,to:1},alpha:{from:1,to:.5},duration:1e3,ease:"Power2"})):(this.countdownText.setText("GO!"),this.tweens.add({targets:this.countdownText,alpha:0,duration:500,delay:500,onComplete:()=>{var e;(e=this.countdownText)==null||e.destroy(),this.countdownText=null}})))}),this.pongClient.on("game_state",t=>{this.updateGameState(t);const e=this.scene.get("PongUIScene");e&&e.updateScore&&e.updateScore(t.score1,t.score2)}),this.pongClient.on("game_over",t=>{this.handleGameOver(t.winner,t.finalScore)}),this.pongClient.on("opponent_disconnected",()=>{this.handleOpponentDisconnect()}))}updateGameState(t){this.ball&&(this.ball.updatePosition(t.ballX,t.ballY),Math.random()<.3&&this.ball.addTrailEffect()),this.leftPaddle&&this.leftPaddle.updatePosition(t.paddle1Y),this.rightPaddle&&this.rightPaddle.updatePosition(t.paddle2Y),this.leftAvatar&&this.leftAvatar.updatePosition(t.paddle1Y),this.rightAvatar&&this.rightAvatar.updatePosition(t.paddle2Y)}update(){this.handlePaddleInput()}handlePaddleInput(){var e,n,o,a;if(!this.pongClient)return;let t=this.paddleTargetY;(e=this.cursors)!=null&&e.up.isDown||(n=this.wasd)!=null&&n.up.isDown?t-=r.PADDLE_SPEED:((o=this.cursors)!=null&&o.down.isDown||(a=this.wasd)!=null&&a.down.isDown)&&(t+=r.PADDLE_SPEED),t=c.Math.Clamp(t,r.PADDLE_HEIGHT/2,r.CANVAS_HEIGHT-r.PADDLE_HEIGHT/2),this.paddleTargetY=t,this.pongClient.movePaddle(t)}handleGameOver(t,e){console.log("Game over!",t,e);const n=t===this.yourSide;this.scene.stop("PongUIScene"),this.scene.start("PongGameOverScene",{didWin:n,yourScore:this.yourSide==="left"?e.left:e.right,opponentScore:this.yourSide==="left"?e.right:e.left,opponent:this.opponent,pongClient:this.pongClient})}handleOpponentDisconnect(){console.log("Opponent disconnected"),this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,`Opponent Disconnected

You Win by Default!`,{fontSize:"32px",color:"#ffffff",align:"center"}).setOrigin(.5),this.time.delayedCall(3e3,()=>{var e,n;this.yourSide==="left"?(e=this.leftPaddle)!=null&&e.getTop():(n=this.rightPaddle)!=null&&n.getTop(),this.handleGameOver(this.yourSide,{left:this.yourSide==="left"?r.WINNING_SCORE:0,right:this.yourSide==="right"?r.WINNING_SCORE:0})})}}class _ extends c.Scene{constructor(){super({key:"PongUIScene"});i(this,"leftScoreText",null);i(this,"rightScoreText",null);i(this,"winningScoreText",null)}create(){var o;const{width:t,height:e}=this.cameras.main;this.leftScoreText=this.add.text(t/4,80,"0",{fontSize:"96px",color:"#4a90e2",fontStyle:"bold"}),this.leftScoreText.setOrigin(.5),this.leftScoreText.setAlpha(.6),this.rightScoreText=this.add.text(t*3/4,80,"0",{fontSize:"96px",color:"#ff6b6b",fontStyle:"bold"}),this.rightScoreText.setOrigin(.5),this.rightScoreText.setAlpha(.6),this.winningScoreText=this.add.text(t/2,30,`First to ${r.WINNING_SCORE}`,{fontSize:"16px",color:"#888888"}),this.winningScoreText.setOrigin(.5),this.add.text(t/2,e-20,"ESC to quit",{fontSize:"14px",color:"#666666"}).setOrigin(.5),(o=this.input.keyboard)==null||o.on("keydown-ESC",()=>{this.quitGame()})}updateScore(t,e){this.leftScoreText&&(this.leftScoreText.setText(t.toString()),parseInt(this.leftScoreText.text)!==t&&this.tweens.add({targets:this.leftScoreText,scale:{from:1.2,to:1},duration:300,ease:"Back.out"})),this.rightScoreText&&(this.rightScoreText.setText(e.toString()),parseInt(this.rightScoreText.text)!==e&&this.tweens.add({targets:this.rightScoreText,scale:{from:1.2,to:1},duration:300,ease:"Back.out"}))}quitGame(){var o;const t=this.add.text(this.cameras.main.width/2,this.cameras.main.height/2,`Are you sure you want to quit?

Press ESC again to confirm`,{fontSize:"24px",color:"#ffffff",align:"center",backgroundColor:"#000000",padding:{x:20,y:20}});t.setOrigin(.5);const e=(o=this.input.keyboard)==null?void 0:o.addKey(c.Input.Keyboard.KeyCodes.ESC),n=()=>{this.scene.stop("PongGameScene"),this.scene.stop("PongUIScene"),window.location.href="/"};e==null||e.once("down",n),this.time.delayedCall(3e3,()=>{t.destroy(),e==null||e.off("down",n)})}}class I extends c.Scene{constructor(){super({key:"PongGameOverScene"});i(this,"didWin",!1);i(this,"yourScore",0);i(this,"opponentScore",0);i(this,"opponent",null);i(this,"pongClient",null);i(this,"leaderboard",[])}init(t){this.didWin=t.didWin,this.yourScore=t.yourScore,this.opponentScore=t.opponentScore,this.opponent=t.opponent,this.pongClient=t.pongClient}async create(){var l;const{width:t,height:e}=this.cameras.main;this.add.rectangle(0,0,t,e,0,.95).setOrigin(0);const n=this.add.text(t/2,150,this.didWin?"VICTORY!":"DEFEAT",{fontSize:"72px",color:this.didWin?"#4ade80":"#ff6b6b",fontStyle:"bold"});n.setOrigin(.5),this.tweens.add({targets:n,scale:{from:0,to:1},alpha:{from:0,to:1},duration:500,ease:"Back.out"});const o=this.add.container(t/2,280),a=this.add.text(0,0,`You: ${this.yourScore}  -  ${((l=this.opponent)==null?void 0:l.displayName)||"Opponent"}: ${this.opponentScore}`,{fontSize:"32px",color:"#ffffff"});a.setOrigin(.5),o.add(a),await this.submitResult(),this.awardHoneyPoints(),this.displayStats(t/2,380),await this.loadAndDisplayLeaderboard(t/2,550),this.createButtons(t/2,e-150)}async submitResult(){var t,e;try{this.didWin?(await h.submitWin({opponent:(t=this.opponent)==null?void 0:t.displayName,your_score:this.yourScore,opponent_score:this.opponentScore}),console.log("‚úÖ Win submitted to BEARpark")):(await h.submitLoss({opponent:(e=this.opponent)==null?void 0:e.displayName,your_score:this.yourScore,opponent_score:this.opponentScore}),console.log("‚úÖ Loss submitted to BEARpark"))}catch(n){console.error("‚ùå Error submitting result:",n)}}awardHoneyPoints(){try{typeof window.handlePongGameCompletion=="function"?(window.handlePongGameCompletion(),console.log("‚úÖ Honey points handler called")):console.log("‚ö†Ô∏è Honey points handler not found - game may not be embedded in BEARpark site")}catch(t){console.error("‚ùå Error calling honey points handler:",t)}}displayStats(t,e){const n=h.getLocalStats(),o=this.add.container(t,e),a=this.add.text(0,0,"Your Stats",{fontSize:"24px",color:"#4a90e2",fontStyle:"bold"});a.setOrigin(.5),o.add(a);const l=this.add.text(0,40,`Wins: ${n.wins}  |  Losses: ${n.losses}  |  Win Rate: ${(n.winRate*100).toFixed(1)}%`,{fontSize:"18px",color:"#ffffff"});l.setOrigin(.5),o.add(l),o.setAlpha(0),this.tweens.add({targets:o,alpha:1,duration:500,delay:300})}async loadAndDisplayLeaderboard(t,e){const n=this.add.container(t,e),o=this.add.text(0,0,"Top Players",{fontSize:"24px",color:"#4a90e2",fontStyle:"bold"});o.setOrigin(.5),n.add(o);const a=this.add.text(0,40,"Loading...",{fontSize:"16px",color:"#888888"});a.setOrigin(.5),n.add(a);try{if(this.leaderboard=await h.getLeaderboard(5),a.destroy(),this.leaderboard.length>0)this.leaderboard.forEach((l,p)=>{var y,w;const u=h.formatDisplayName(l),T=l.score||((y=l.metadata)==null?void 0:y.wins)||0,P=((w=l.metadata)==null?void 0:w.losses)||0,S=this.add.text(0,40+p*30,`${p+1}. ${u} - ${T}W ${P}L`,{fontSize:"16px",color:"#ffffff"});S.setOrigin(.5),n.add(S)});else{const l=this.add.text(0,40,"No leaderboard data yet",{fontSize:"16px",color:"#888888"});l.setOrigin(.5),n.add(l)}}catch(l){a.setText("Failed to load leaderboard"),console.error("Error loading leaderboard:",l)}n.setAlpha(0),this.tweens.add({targets:n,alpha:1,duration:500,delay:600})}createButtons(t,e){const n=this.add.text(t,e,"[ Play Again ]",{fontSize:"24px",color:"#4ade80"});n.setOrigin(.5),n.setInteractive({useHandCursor:!0}),n.on("pointerover",()=>{n.setScale(1.1)}),n.on("pointerout",()=>{n.setScale(1)}),n.on("pointerdown",()=>{this.playAgain()});const o=this.add.text(t,e+60,"[ Main Menu ]",{fontSize:"20px",color:"#888888"});o.setOrigin(.5),o.setInteractive({useHandCursor:!0}),o.on("pointerover",()=>{o.setScale(1.1),o.setColor("#ffffff")}),o.on("pointerout",()=>{o.setScale(1),o.setColor("#888888")}),o.on("pointerdown",()=>{this.returnToMenu()}),n.setAlpha(0),o.setAlpha(0),this.tweens.add({targets:[n,o],alpha:1,duration:500,delay:900})}playAgain(){this.pongClient&&this.pongClient.disconnect(),this.scene.start("PongLobbyScene")}returnToMenu(){this.pongClient&&this.pongClient.disconnect(),window.location.href="/"}}const O={type:c.AUTO,width:720,height:1280,parent:"game-container",backgroundColor:"#000000",scale:{mode:c.Scale.FIT,autoCenter:c.Scale.CENTER_BOTH},scene:[E,D,_,I],physics:{default:"arcade",arcade:{debug:!1,fps:60}}},L=new c.Game(O);L.scene.start("PongLobbyScene");console.log("üéÆ BEAR PONG initialized");console.log("üîå Server URL:","ws://localhost:8080");
