<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, minimal-ui" />

  <!-- Mobile fullscreen support -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#000000">

  <title>BEAR PONG - Multiplayer</title>

  <!-- BROWSER COMPATIBILITY: Polyfills for old browsers (Opera, Brave, Edge, old Android/iOS) -->
  <script>if (typeof Promise === 'undefined') { document.write('<script src="https://cdn.jsdelivr.net/npm/promise-polyfill@8/dist/polyfill.min.js"><\/script>') }</script>
  <script
    src="https://polyfill.io/v3/polyfill.min.js?features=es6,fetch,URLSearchParams,Array.from,Object.assign,Element.prototype.classList,requestAnimationFrame,PointerEvent"></script>
  <script>
    (function () {
      if (!window.URLSearchParams) { var s = document.createElement('script'); s.src = 'https://cdn.jsdelivr.net/npm/url-search-params-polyfill@8.2.0/index.js'; document.head.appendChild(s); }
      if (!window.PointerEvent) { window.PointerEvent = function (type, params) { params = params || { bubbles: false, cancelable: false }; var evt = document.createEvent('MouseEvent'); evt.initMouseEvent(type, params.bubbles, params.cancelable, params.view || window, params.detail || 0, params.screenX || 0, params.screenY || 0, params.clientX || 0, params.clientY || 0, params.ctrlKey || false, params.altKey || false, params.shiftKey || false, params.metaKey || false, params.button || 0, params.relatedTarget || null); return evt; }; }
      if (!window.requestAnimationFrame) { window.requestAnimationFrame = window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || function (cb) { return setTimeout(cb, 16) }; }
    })();
  </script>

  <!-- BEAR Park Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&display=swap" rel="stylesheet" />

  <!-- BEAR Park Authentication - Read URL params and store to localStorage -->
  <script>
    (function () {
      try {
        // Read URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const wallet = urlParams.get('wallet');
        const displayName = urlParams.get('display_name');
        const twitterUsername = urlParams.get('twitter_username');
        const avatarUrl = urlParams.get('avatar_url');

        // Store to localStorage if provided
        if (wallet) {
          localStorage.setItem('xaman_wallet_address', wallet);
        }

        if (displayName) {
          localStorage.setItem('display_name', displayName);
        }

        if (twitterUsername) {
          localStorage.setItem('twitter_username', twitterUsername);
        }

        if (avatarUrl) {
          localStorage.setItem('avatar_url', avatarUrl);
        }

        // Clean URL after reading params (optional - removes params from address bar)
        if (wallet || displayName || twitterUsername || avatarUrl) {
          const cleanUrl = window.location.origin + window.location.pathname;
          window.history.replaceState({}, document.title, cleanUrl);
        }
      } catch (error) {
        console.error('Error reading BEAR Park authentication data:', error);
      }
    })();
  </script>

  <!-- Mobile Fullscreen Trigger -->
  <script>
    (function () {
      const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
      const isAndroid = /Android/.test(navigator.userAgent);

      function enterFullscreen() {
        if (isIOS) {
          setTimeout(() => { window.scrollTo(0, 1); }, 100);
          return;
        }

        const elem = document.documentElement;
        if (elem.requestFullscreen) {
          elem.requestFullscreen().catch(() => { });
        } else if (elem.webkitRequestFullscreen) {
          elem.webkitRequestFullscreen();
        } else if (elem.webkitEnterFullscreen) {
          elem.webkitEnterFullscreen();
        } else if (elem.mozRequestFullScreen) {
          elem.mozRequestFullScreen();
        } else if (elem.msRequestFullscreen) {
          elem.msRequestFullscreen();
        }
      }

      let fullscreenTriggered = false;

      const triggerFullscreen = (event) => {
        if (fullscreenTriggered) return;
        fullscreenTriggered = true;
        enterFullscreen();
        document.removeEventListener('touchstart', triggerFullscreen);
        document.removeEventListener('click', triggerFullscreen);
        document.removeEventListener('pointerdown', triggerFullscreen);
      };

      document.addEventListener('touchstart', triggerFullscreen);
      document.addEventListener('click', triggerFullscreen);
      document.addEventListener('pointerdown', triggerFullscreen);

      window.enterFullscreen = enterFullscreen;
      window.isIOS = isIOS;
    })();
  </script>

  <!-- ðŸ¯ HONEY POINTS: Load game points helper -->
  <script src="./game-points-helper.js"></script>


  <style>
    html,
    body {
      background: black;
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      overscroll-behavior: none;
    }

    #game-container {
      width: 100%;
      height: 100%;
    }

    /* Let Phaser handle canvas positioning */
    #game-container canvas {
      display: block;
    }
  </style>
  <script type="module" crossorigin src="./assets/index-r9o9D_Vc.js"></script>
  <link rel="modulepreload" crossorigin href="./assets/phaser-0YPJO2g1.js">
</head>

<body>
  <div id="game-container"></div>
</body>

</html>